---
title: Nantucket Sound Sea Ducks
author: Adam D. Smith, Benjamin Hofner, Jason E. Osenkowski, Taber Allison, Scott R. McWilliams, and Peter W. C. Paton
date: "`r format(Sys.time(), '%d %B, %Y')`"
header-includes:
  - \usepackage[utf8]{inputenc} 
  - \usepackage[parfill]{parskip}
#  - \usepackage{amsmath}
#  - \usepackage{soul}
#  - \usepackage{graphicx}
#  - \usepackage{caption}
#  - \captionsetup[figure]{labelfont=bf}
output: 
#  pdf_document:
#    pandoc_args: [
#      "--filter", "pandoc-fignos"
#    ]
#    toc: true
#    toc_depth: 3
  word_document:  
fontsize: 12pt
geometry: margin=1in
number_sections: true
documentclass: article
bibliography: NantucketMS.bib
csl: ecology.csl
---

```{r chunk-opts, echo=FALSE}
# Set some knitr chunk options
options(width = 250, scipen=999)
knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE, 
               fig.path="./Rpubs/figs/", 
               cache.path="./Rpubs/cache/")
```

```{r load-options-data}
# Aliases and functions
# Requires devtools package to be installed
# You should also install Rtools (http://cran.r-project.org/bin/windows/Rtools/)
# install.packages("devtools")
require(devtools)
source_gist(9216051) # Rprofile.R
source_gist(9216061) # various.R

#install_github("hofnerb/stabs")
#install_github("hofnerb/mboost/pkg/mboostPatch")
#install_github("hofnerb/gamboostLSS/pkg")

# Necessary packages; other packages may be loaded as other files are sourced
toLoad = c("Hmisc", "ggplot2", "grid", "gridExtra", "rgdal", "lubridate",
           "reshape", "plyr", "dplyr", "gamlss.tr", "gamboostLSS")
instant_pkgs(toLoad); rm(toLoad)

# Load sea duck data sets
# This includes:
#   env.segs - environmental data from all (504) segments on all (30) survey dates; includes
#              field (length) that indicates the amount of survey effort (if any) on a given
#              date
#   obs.final - segment level count summaries for each species/group
load("../Data/ducks&environment.RData")

# For each group, load/create data sets for various analyses
# This creates the (1) final survey data set (e.g., coei), (2) zero-truncated
#   data set (i.e., at least 1 duck observed; e.g., coei_zerotrunc), and 
#   (3) presence/absence data set (e.g., coei_zero) 
source("../R/load_sea_duck_data.R")

# Loading & renaming the sea duck occupancy and hurdle models
# Note, loading the sea duck models will not work with Github given file size limitations
# At present, it accesses the models stored on a local drive
# Can we store the files online somewhere and access them that way? Dryad?

# Loading all these bogs down the memory and possibly kills R when running some of the 
# predict functions; it depends on how much RAM you have
# Updated all relevant scripts to load and remove models (and garbage collect) as needed
#source("../R/load_sea_duck_models.R") # takes a couple of minutes

# Load predict function for combined occupancy/count models
source("../R/predict.gamlssHurdle.R")
```

```{r get_predictions, eval=FALSE}
# For each group, create data for prediction
# This does two important things: (1) creates the final data set over which 
#   model predictions are desired (e.g., coei_pred) and (2) calculates the average
#   of relevant variables (covar_avgs) so that partial effect plots can be placed
#   on their original scale for easier interpretation
source("../R/create_new_data.R")
source("../R/predict_from_new_data.R")

# To save time, we alternatively provide the products of this process: 
#   coei_final, scot_final, ltdu_final
load("../Data/prediction_data.Rda")
```

A basic tenet of ecology is that biophysical features affect the distribution and abundance of organisms at multiple spatial and temporal scales [@MacArthur1972; @Andrewartha1986; @Rose1990; @Maurer1999].  However, identifying the biophysical features preponderant to animal distribution and abundance is complicated because this influence may be direct via biological or physiological constraints (e.g., bathymetry constrains foraging depth) or indirect via the regulation of the distribution and abundance of important resources (**do we need citations for this sentence?**). These indirect influences are particularly important to the distribution and abundance of higher trophic-level predators in marine ecosystems, but the typically complex spatiotemporal dynamics of marine prey make them challenging to monitor and often relegates us to the use of biophysical features as speculative surrogates for the distribution and abundance of key resources [@Kirk2008; @Robinson2011; @Boyd2015].  Human activities that alter the distribution and availability of potential prey, either directly or via biophysical alterations of the environment, likewise can affect the spatial ecology of higher trophic-level marine organisms [@Bertrand2012; @Langston2013].  Characterizing the spatial ecology of marine predators, as well as detecting and quantifying the potential effects of human activities on distribution and abundance, requires a flexible, spatially-explicit modeling approach that arbitrates many potentially relevant biophysical features and accommodates the analytical challenges inherent in most animal survey data.

Model-based approaches are a useful framework to generate spatially-explicit estimates of animal abundance and changes in animal distribution independent of abundance [@Borchers2002; see, e.g., @Certain2008; @Nur2011; @Kinlan2012; @Winiarski2014]. Nonetheless, the spatial ecology of marine organisms typically presents several analytical challenges:  the spatiotemporal distribution of marine organisms can be highly irregular which, when surveyed, produces zero-inflated [@Cunningham2005; @Martin2005],  overdispersed [@Richards2008] count data that may vary with biophysical features in complex, non-linear ways [@Austin2007].  Moreover, an adequate modeling approach must identify a typically small suite of important covariates among many potentially correlated covariates (i.e., high dimensionality; multicollinearity) while avoiding overfitting models (i.e., describing noise), a process complicated by data from repeated surveys that regularly exhibit spatial and temporal autocorrelation (Hoeting 2009).  We demonstrate a model-based approach to predict animal distribution and abundance that incorporates these considerations using aerial transect survey data of sea ducks in Nantucket Sound, Massachusetts, USA. We implemented generalized additive models [GAMs; @Hastie1990; @Wood2006] and their recent extension [GAMs for location, scale, and shape; GAMLSS; @Rigby2005] in a gradient descent boosting framework [@Hothorn2010; @Mayr2012; @Hofner2015b]. GAMLSS methods extend GAMs to allow all parameters of the conditional response distribution to be modeled as a function of relevant covariates [@Rigby2005]; this approach provides spatially-explicit insights into the covariates associated with sea duck abundance and its variability. The boosting algorithm accommodates the inclusion of various effect types [e.g., linear, smooth, spatial, spatiotemporal, and random effects; @Hofner2014b] and correlated covariates (i.e., parameter estimates are regularized), identifies the most relevant subset among potentially many covariates (i.e., variable selection), and evaluates competing representations of continuous covariates [e.g., linear vs. nonlinear effects of covariates; @Kneib2009; @Maloney2012].

Wintering sea ducks (Tribe: Mergini) represent an appropriate group of marine organisms, and their distribution and abundance an appropriate application, to demonstrate this model-based approach.  Most sea ducks that inhabit North America migrate from high-latitude arctic and sub-arctic breeding areas to mid-latitude temperate wintering areas [@Silverman2013; @Bowman2015]. During the ca. 10-month non-breeding (non-territorial) period of the annual cycle, some species of sea ducks can be highly mobile [@Loring2013] and congregate in very large flocks (thousands of birds) at sites where prey are abundant and accessible [@Flint2013]. Large-scale ocean characteristics [e.g., @Flint2013], climatic conditions [e.g., @Zipkin2010], and static or persistent habitat features [e.g., bathymetry, substrate, current and frontal systems; @Hyrenbach2000] typically associate with large-scale patterns in distribution of marine birds [e.g., @Nur2011].  At regional and local scales, however, the abundance and distribution of prey, and thus predators, can be extremely ephemeral and dynamic [@Hyrenbach2000; @Ortega2011], even relating to prevailing meteorological conditions [e.g., @Garthe2009]. Thus, sea duck distribution and abundance is spatially and temporally dynamic yet expected to be driven by biophysical covariates [@Oppel2009; @Zipkin2010]. Population sizes of most of North American sea duck species are believed below historic levels and with considerable uncertainty in population trajectories [@Bowman2015].  However, despite the anthropogenic vitiation of coastal marine ecosystems [@Lotze2006; @Halpern2008] and the role of sea ducks as top consumers in these ecosystems, the environmental factors associated with their distribution and abundance remain notably understudied. Furthermore, evidence from Europe's numerous offshore wind facilities portends possible negative consequences on sea duck populations of imminent offshore wind development in the northeastern United States [@Larsen2007; @Langston2013]. Thus there exists considerable relevance in quantifying the associations between the spatiotemporal dynamics of sea ducks and the biophysical characteristics of the marine environment.   

Our specific objectives were to demonstrate a flexible, model-based approach that (1) provides spatially- and temporally-explicit estimates of sea duck abundance and distribution while accommodating many of the challenges inherent in animal survey data; and (2) describes the associations between biophysical features and sea duck distribution and abundance in one of the most important migrating and wintering areas in the western Atlantic.

##Methods

*Study area and species.*---We conducted fieldwork throughout Nantucket Sound in Massachusetts, USA (Figure 1). Our study area encompassed ca. 1,500 km^2^, was relatively shallow (generally < 20 m deep), and included some of the most important sea duck wintering habitat in the western Atlantic [@White2009; @Silverman2013].  The primary species of sea ducks found in Nantucket Sound were Common Eider (*Somateria  mollissima*; hereafter eider), Black Scoter (*M. americana*), Surf Scoter (*M. perspicillata*), and White-winged Scoter (*Melanitta deglandi*), and Long-tailed Duck (*Clangula hyemalis*).  Additionally, approximately 62 km^2^ of Horseshoe Shoal in northwestern Nantucket Sound is fully permitted for wind energy (Figure 1), which could affect sea duck use of this important wintering area [@Drewitt2006; @Langston2013; @Winiarski2014].  

*Aerial strip transect surveys.*---During the winters (late October to mid-April) of 2003-2005, we conducted 30 (2003/2004: 13, 2004/2005: 10, 2005/2006: 7) standardized aerial strip-transect surveys [e.g.,@Pollock2006; @Certain2008] throughout an 1,100 km^2^ study area in Nantucket Sound (Figure 1).  Surveys occurred primarily from November - March (n = 27), with occasional October (n = 1) or April (n = 2) surveys. During each survey, we flew along 15 parallel (ca. 2.5 km apart), roughly north-south transects (Figure 1) using a high-wing, twin-engine aircraft (Cessna Skymaster 337) at an average altitude of 152 m and speed of 167 kmh-1 (90 kts). This altitude allowed us to identify most birds at the sea surface and reduced sea disturbance (i.e., flushing birds to another part of the study area and, thus, potential double counting). The airspeed was the slowest at which the aircraft could safely fly. Surveys occurred only on days with wind speeds $\leq$ 15 kts and good visibility (>15 km). Surveys occurred between 0900 to 1600 h (average duration of ~ 2.5 h) to ensure that birds had completed their post-dawn movements [e.g., @Davis1997] but had yet to initiate pre-sunset movements from feeding to roosting areas; this time window also reduced glares due to low sun angles.

On each survey flight, two observers used their unaided eyes to continuously detect individuals or flocks, identifying sea ducks to species with the aid of binoculars as needed. Observers monitored the sea surface on their side of the plane in a ca. 91 m wide transect between ca. 56 - 147 m from the plane; observers could not see beneath the plane out to 56 m on each side. The narrow strip width ensured birds were detectable and identifiable with the naked eye and allowed us to avoid situations in which ducks were too abundant or spread over too wide an area to count accurately. This last point was especially relevant because sea ducks occasionally congregated in extremely large aggregations. We thus assumed inconsequential perception bias [i.e., few missed individuals present to be counted; @Marsh1989] given that our flight altitude and narrow transect width  [e.g., @Certain2008] within the strip transect [@Buckland2012].  Our transect dimensions resulted in the sampling of approximately 6% (median; 68.4 km^2^) of the study area during a survey. 

Observers verbally communicated duck sightings to a recorder, who entered the number of ducks, species, behavior (i.e., on the water or flying), and geographic location into a laptop computer linked to the plane's onboard GPS; we report results only from ducks observed sitting on the water. We subsequently consolidated counts for each species (eider and Long-tailed Duck) or species group (scoter) into 2.25km^2^ segments (Figure 1); this resolution (1.5 km x 1.5 km) corresponded approximately to the coarsest level of resolution of biophysical covariates (see below).

```{r studyarea, eval=FALSE}
# Figure 1 was created using the following script, although for nice formatting
# in the pdf and Word output we simply link to the final PNG file, below
source("../R/map_study_area.R")
```
![Nantucket Sound study area](./Figures/Nantucket_study_area_reduced.png)  
**Figure 1.** Actual aerial strip transect tracks (gray lines) during winter (October - April, 2003 - 2005) sea duck surveys (n = 30) in Nantucket Sound, Massachusetts, US. The grid indicates the extent of the 1100 km^2^ study area and its division into 504 2.25km^2^ segments. The polygon in northwest Nantucket Sound indicates the 62 km^2^ area of permitted wind energy development on Horseshoe Shoal.

*Modeling approach.*---We related spatiotemporal variation in sea duck occupancy (i.e., probability of presence) and abundance to potentially relevant biophysical and spatiotemporal covariates. We applied a negative binomial hurdle model that separately modeled (1) the probability of occurrence of at least one individual (hereafter, the occupancy model) in a given segment using a logistic regression model and (2) the abundance of sea ducks in that segment conditional on their presence (hereafter, the count model) using a truncated negative binomial model. The prevalence of zero counts (e.g., `r round(100 * nrow(coei[coei$count == 0,])/nrow(coei))`% of eider segment observations) prompted the use of a hurdle model. We generated separate hurdle models for each sea duck group [i.e., eider, scoter, and Long-tailed Duck; @Zipkin2010].

To model sea duck occupancy, we used a generalized additive model [GAM; @Hastie1990; @Wood2006] that flexibly accommodated potential nonlinearities between covariates and sea duck occupancy.  We used generalized additive models for location, scale, and shape [GAMLSS; @Rigby2005] to fit the count models; these models accommodated potential nonlinearities between covariates and the conditional mean and overdispersion of sea duck abundance. 

We implemented GAMs and GAMLSS in a gradient descent boosting framework [@Mayr2012; @Hofner2015b]. More specifically, we used component-wise functional gradient descent boosting to fit the models.  Briefly, one begins by computing the negative gradient of a user-specified loss function (typically the negative log-likelihood of the underlying model); the negative gradient can be viewed as a proxy for residuals. We used the negative binomial log-likelihood as the loss function for occupancy models and the (negative) truncated negative binomial log-likelihood as the loss function for count models. In the next step, all modeling alternatives [i.e., functional forms of the covariates relative to the response, called base-learners; @Hofner2014] are fitted separately to the negative gradient and a fraction of the best fitting base-learner is added to the current model fit. The negative gradient is then reevaluated at the current model fit and the procedure iterated until for a fixed number of iterations, *$m_\text{stop}$*, specified by the user [see @Buhlmann2007 for additional details]. Boosted GAMLSS models are fitted similarly, although in each iteration the negative gradient is computed separately with respect to each GAMLSS parameter (e.g., mean and overdispersion) while holding other parameters as fixed constants.  Base-learners are then fitted to the resulting parameter-specific negative gradient vector and model updates are computed separately for each GAMLSS parameter as for boosted GAMs [see @Mayr2012 for additional details].

As only the single best-fitting base-learner is selected in each iteration, the algorithm thus integrates intrinsic selection of the most relevant covariates and their functional form (i.e., some base-learners may never be selected).  Variable selection is further fostered  by stopping the algorithm prior to convergence to maximum likelihood estimates [early stopping; @Mayr2012; @Maloney2012]. Furthermore, early stopping aims at maximizing predictive accuracy while avoiding model overfitting.  We used 25-fold subsampling to determine the optimal stopping iteration for each model.  Specifically, we randomly drew (without replacement) 25 samples of size $n/2$ from the original data set. We used the selected sample to estimate the model and the balance of the data in each sample to determine the out-of-bag prediction accuracy (empirical risk) measured by the negative log-likelihood of each model; the optimal stopping iteration ($\hat{m}_\text{stop}$) is the iteration with the lowest average empirical risk. In boosted GAMLSS models we used multi-dimensional subsampling to determine the stopping iteration for each of the GAMLSS parameters while allowing for potentially different model complexities in the parameters; a detailed explanation of this cross-validation (subsampling) scheme is given in @Hofner2014b.

Despite these agreeable features, boosting methods typically produce "rich" models relying to some extent on many base-learners [@Hofner2015a].  Thus, we additionally applied stability selection [@Meinshausen2010; @Shah2013] to identify those base-learners, and thus covariates, most commonly selected in each model while preserving an upper bound of $\alpha$ ~ `r round(3/48, 2)` for the per-comparison error rate; Appendix 1 and @Hofner2015b provide more details.

*Covariates.*---We evaluated biophysical covariates expected to influence the distribution, abundance, and movements of sea ducks or, more likely, the distribution and availability of their benthic prey (e.g., mollusks and crustaceans; see Appendix 2); we did not have information related directly to the distribution of preferred prey.  Biophysical covariates could be characterized as strictly spatial or temporal effects (i.e., varying only among segments or within or among winters, respectively) or as spatiotemporal effects (i.e., varying among segments and within or among winters; see Appendix 2). Additionally, we included interactions that allowed the effects of two covariates to vary over time within a given winter (see Appendix 2).  We standardized (i.e., mean centered and scaled) all continuous covariates.  Appendix 3 describes a function to visualize the spatial and temporal distribution of covariates in Nantucket Sound.

For each continuous covariate, we specified two base-learners: a linear base-learner and a penalized nonlinear base-learner [i.e., P-splines; @Eilers1996; @Schmid2008].  We dummy-coded categorical covariates, resulting in *K* - 1 linear base-learners for a *K*-level covariate.  To address potential spatial autocorrelation, we included a smooth surface function of the spatial coordinates of segment centers [@Kneib2008]; this surface comprised four base-learners -- linear base-learners for the easting and northing, their linear interaction, and a penalized nonlinear tensor product P-spline [@Kneib2008; @Kneib2009; @Maloney2012].  We also allowed this surface to vary over (interact with) time within a winter.  @Hofner2014 describe base-learners in detail. 

The decomposition of continuous covariates into centered linear and penalized orthogonal nonlinear base-learners allowed us to weight base-learners equally and thus allowed unbiased model choice [i.e., prevented the preferential selection of smooth base-learners; @Kneib2009; @Hofner2011].  Specifically, we restricted each base-learner to a single degree of freedom and omitted the intercept term from each base-learner [@Kneib2009; @Hofner2011].  Consequently, we added an explicit linear base-learner for the model intercept. The occupancy and count models had the following structure (see Appendix 2 for descriptions of abbreviated covariates):

\begin{equation}
\begin{aligned}
g(\cdot) =  & int + time + f(time) + SSTw + f(SSTw) + SSTm + f(SSTm) + SSTrel +\\
     & f(SSTrel) + SSTrel \cdot time + f(SSTrel, time) + SBT + f(SBT) + NAOw + \\
     & depth + f(depth) + depth \cdot time + f(depth, time) + d2land + f(d2land) +\\
     & chla + f(chla) + cdom + f(cdom) + f(cdom, chla) + meanphi + f(meanphi) +\\
     & SAR + f(SAR) + tidebmean + f(tidebmean) + tidesd + f(tidesd) + strat +\\
     & f(strat) + ferry + y2004 + y2005 + xkm + ykm + xkm \cdot ykm + \\
     & f(xkm, ykm) + xkm \cdot time + ykm \cdot time + xkm \cdot ykm \cdot time + \\
     & f(xkm, ykm) \cdot time + obs\_window + f(obs\_window).  
\end{aligned}
\end{equation}

In our occupancy models, $g(\cdot)$ is $g(\pi_{\text{sea ducks}})$, the occupancy probability of a given duck species in a segment and $g$ is the logit link.  In our count models, $g(\cdot)$ took two forms within the GAMLSS framework -- the (conditional) mean count of sea ducks, $g(\mu_{\text{sea ducks}})$, and the (conditional) overdispersion in sea duck counts, $g(\sigma_{\text{sea ducks}})$; $g$ is the log link in both cases.  Base-learners denoted as $f(\cdot)$ indicate the penalized nonlinear deviations from the corresponding linear base-learner (e.g., $f(time)$). The explicit intercept (*int*) was a necessary byproduct of our decomposition of base-learners [see above; @Kneib2009; @Hofner2011].  Small values of *obs_window*, our measure of survey effort (see Appendix 2), in some segments impaired the estimability of models including *obs_window* as an offset; we thus included it as a covariate.

To evaluate the approximate explanatory power of our final models, we calculated a pseudo *R*^2^ measure of the explained variation [@Nagelkerke1991; @Maloney2012]. 

All analyses were conducted in R [Version 3.1.3; @RCoreTeam2014] with the add-on packages gamboostLSS [@Hofner2015b], mboost [@Hothorn2015], and stabs [@Hofner2015].  The data and code for reproducing this manuscript and analyses are given as an online electronic supplement at *TBD*.

## Results

As the occupancy and the hurdle model are independent, we fitted two models per sea duck species. Bootstrapped empirical risk suggested that occupancy models for all species converged on the maximum likelihood estimates (i.e., occupancy models failed to stop early; see Appendix 4). Conversely, bootstrapped empirical risks prescribed early stopping for both parameters (i.e., conditional mean and overdispersion) in all count models (see Appendix 4).  Consequently, final occupancy models generally contained more covariates than did count models, particularly among stably selected covariates and their interactions.  This suggests that the effects of the environmental variables on sea duck occupancy were more complex than their effect on sea duck abundance.  Nonetheless, final occupancy and count (conditional mean) models included only a subset (12% to 38%) of the 48 base-learners initially specified for selection (see equation 1).  This translated into the selection of only 8-10 (of 23) covariates and their interaction in occupancy models and 3-6 covariates and their interactions in conditional count (mean) models (Figure 2).

```{r evaluate_models, eval=FALSE, cache=TRUE}
source("../R/pseudoR2.R")
(COEI_r2 <- round(pseudoR2(COEIocc, COEIcc, coei, engine = "pscl"), 2))
(SCOT_r2 <- round(pseudoR2(SCOTocc, SCOTcc, scot, engine = "pscl"), 2))
(LTDU_r2 <- round(pseudoR2(LTDUocc, LTDUcc, ltdu, engine = "pscl"), 2))
```

*Sea duck occupancy.*---The suite of stably selected covariates associated with occupancy was relatively consistent among sea duck species (Figure 2).  When interpreting Figure 2, the influence of univariate effects (i.e., lines) on the response is reflected in the range of the effect over the Y-axis and, due to standardization, can be compared among species and covariates within a model.  For example, monthly sea surface temperature (*SST~m~*) associated more strongly with eider occupancy than did distance to land (*d2land*) because it spanned a larger range of the Y-axis (Figure 2).  However, monthly sea surface temperature (*SST~m~*) associated much more strongly with occupancy of Long-tailed Duck than eider for the same reason (Figure 2).  Covariate interactions, illustrated with bivariate plots, are similarly comparable within a model.  Only the general association (i.e., positive or negative) with the additive predictor is given for factor variables. Comparing univariate, bivariate, and categorical effects is accomplished using the detailed covariate plots for eider, scoter, and Long-tailed Duck (Appendices 5 - 7, respectively); these plots are ordered in descending order of effect size within a model, and provide values for the partial contribution to the additive predictor for covariates and their interactions.  

Spatiotemporal effects (i.e., occupancy associated with the *xkm-ykm* location of segments and the change over time within winter) were the dominant explanatory feature in sea duck occupancy models, although the spatiotemporal patterns of occupancy varied considerably among species (Figure 2).  Sea duck occupancy increased, but at a decreasing rate, with survey effort (*obs_window*) in a given segment (Figure 2).  Among biophysical covariates, sea duck occupancy increased at intermediate monthly sea surface temperature (*SST~m~*), particularly (and at somewhat warmer temperatures) in Long-tailed Ducks.  Sea duck occupancy also increased modestly at greater distances from land (*d2land*), although eider occupancy was lowest at intermediate distances.  Scoter and especially eider occupancy was greater in areas with coarser sediments (i.e., smaller *meanphi*; Figure 2).  Furthermore, eider occupancy associated negatively with chromomorphic dissolved organic material (*cdom*) and positively with sea floor surface:planimetric area (*SAR*), our measure of the topographic variability of the sea floor (Figure 2); scoter occupancy likewise related to *SAR* and *cdom*, but in the opposite direction in both cases (Figure 2).  Scoter occupancy was modestly greater in deeper waters (*depth*); Long-tailed Duck occupancy was greatest in shallow waters early in the winter but in deeper waters later in the winter (Figure 2).  Other effects were relatively minor and inconsistent among species. 

Spatially-explicit maps of median occupancy over the course of the study (Figure 3, top row) convey the dominant influence of strictly spatial (i.e., segment *xkm-ykm* location) effects. The result is quite distinct patterns of occupancy among species despite the relative similarity of occupancy associations with biophysical covariates (Figure 2).  Occupancy was typically highest for eider in northwest and southwest Nantucket Sound, in interior Nantucket Sound for scoter, and in northeast and south Nantucket Sound for Long-tailed Duck (Figure 3, top row).  All species relatively avoided the western edge of the Sound northeast of Martha's Vineyard (see Figure 1).  Generally, the areas of highest occupancy exhibited the lowest relative variability (Figure 3, bottom row), defined as the median absolute deviation (MAD) of occupancy relative to median occupancy within a segment (a measure analogous to the coefficient of variation).

*Sea duck conditional abundance and overdispersion.*---In contrast to occupancy, fewer covariates associated consistently with the abundance of sea ducks, conditional on their presence, and the suite of stably selected effects varied more markedly among sea duck species  (Figure 2; see also Appendices 5 - 7).  However, most selected variables fell within the suite of covariates selected in occupancy models.  The primary exception to this pattern was the increase in eider and scoter abundance, conditional on presence, associated with relatively warm or cool sea surface temperatures (*SST~rel~*; Figure 2).  Spatial effects (*xkm-ykm*) were again the dominant explanatory feature in scoter and Long-tailed Duck, but they were not selected in the eider model (Figure 2).  For a given species, biophysical covariates selected in occupancy and count models exhibited broad agreement with the exception of sediment grain size (*meanphi*) in scoter and more complex relationships between eider conditional abundance and dissolved organic material (*cdom*) and sea floor topography (*SAR*; Figure 2).

Spatially-explicit patterns of median conditional abundance (Figure 4, top row) did not necessarily reflect patterns of occupancy (Figure 3, top row).  Some areas of Nantucket Sound exhibited mutually high conditional abundance and occupancy for a given species (e.g., eider in the southwest, scoter in the interior, and Long-tailed Ducks in parts of the northeast).  In some cases, however, conditional abundance was low despite relatively high occupancy (e.g., eider in the northeast and Horseshoe Shoal, scoter in the northeast and southeast, and Long-tailed Duck along the northern margin).  Conversely, other areas of Nantucket Sound exhibited lower occupancy but sea ducks, when present, were more abundant (e.g., eider along the eastern margin, and scoter and Long-tailed Duck in the southwest). As in occupancy models, sea ducks were relatively absent from the middle western margin of Nantucket Sound (i.e., northeast of Martha's Vineyard; see Figure 1).  In contrast to sea duck occupancy, howver, areas of highest conditional sea duck abundance typically exhibited the highest relative variability over time (Figure 4, bottom row). 

Overdispersion in conditional sea duck abundance also varied with biophysical covariates, although there was less consistency in the associated covariates among species (Figure 2; see also Appendices 5 - 7).  Variability (i.e., overdispersion) in sea duck counts was heterogeneous in space (Appendix 8; Figure 8.1, top row) and time (Appendix 8; Figure 8.2, bottom row) in Nantucket Sound, particularly for eider and scoter (as indicated by the magnitude of the overdispersion parameter values).  

*Expected sea duck abundance.*---We consolidated occupancy and conditional count models [see, e.g., Equation 6 in @Zeileis2008] to estimate expected (average) sea duck abundance in the study area over the survey period (Figure 6, top row).  Final models of expected sea duck abundance explained moderate amounts of variation in observed counts of eider, scoter, and Long-tailed Duck (pseudo *R*^2^ = 0.31, 0.48, and 0.32, respectively).  Conditional abundance (Figure 4) strongly influenced the spatially-explicit patterns of expected abundance.  Sea duck species exhibited relatively distinct patterns of abundance in Nantucket Sound.  Eider were most abundant, and relatively consistently so over time, in southwestern Nantucket Sound (Figure 5); eider were also relatively abundant in northeastern part of the sound but less consistently so as evidenced by the relatively high MAD/median abundance over time (Figure 5, bottom row).  Scoter were also most abundant, occasionally extremely so, in southwestern Nantucket Sound, although this was also the area of highest relative variation in scoter abundance (Figure 5); relatively high abundances of scoter also occurred in interior Nantucket Sound (Figure 5).  Long-tailed Ducks were consistently most abundant in northeastern Nantucket Sound, as well as along its southern margin (Figure 5).  No species' highest abundances occurred in the permitted Nantucket Shoal area, although expected eider and scoter abundances were consistently elevated in some parts of the Shoal (west and southeast, respectively; Figure 5). 

Summing the spatially explicit estimates of expected sea duck abundance (i.e., Figure 5) provides an estimate of total animal abundance in a 1.5 km x 180 m transect through all segments in the study area.  We elected to compare the total number of each sea duck species observed in aerial strip transects with the corresponding total (summed) expected abundance in surveyed segments for each of the 30 aerial surveys (Figure 6).  Our models tended to overestimate sea duck abundance when the actual numbers of sea ducks were relatively low, although overestimation was typically less than an order of magnitude.  Additionally, scoter abundance was occasionally extreme relative to typical counts and somewhat prone to underestimation during these extreme counts.  Nonetheless, the general adherance of observed and predicted abundance to a line of unit slope indicated that it may be reasonable to estimat sea duck abundance for the entire study area based on observed sea duck densities in transects.

*Temporal dynamics in wintering sea ducks.*---The MAD/median maps (bottom rows of Figures 3-5) emphasize something important but perhaps not obvious -- that our spatially-explicit estimates of occupancy, abundance, and overdispersion invariably change over time, either explicitly via the selection of a within- or among-winter temporal effect (*time* and *y2004*/*y2005*, respectively) or implicitly via the selection of biophysical covariates that change within or among winters.  The temporal dynamic of the wintering sea duck system in Nantucket Sound was one of its most striking attributes.  Appendix 9 illustrates the dynamic nature of occupancy and average abundance in Nantucket Sound using scoter data during the 2005 winter.

\pagebreak
```{r covariate_plot, eval=FALSE}
# Figure 2 was created using the following script, although some manual editing
# was required to add model column headings.  For nice formatting in the pdf and Word
# output we simply link to the final PNG file, below.
source("../R/assemble_covariate_plot.R")
```
![Covariate effect plot](./Figures/Covariate_effects.png)  
**Figure 2.** Marginal functional plots for stably selected covariates in the occupancy (probability of presence) and conditional abundance (mean and overdispersion of count model) of Common Eider (COEI), scoter (SCOT), and Long-tailed Duck (LTDU) in Nantucket Sound during winters 2003 - 2005.  Plots illustrate the partial contribution to the additive predictor of a covariate holding all other covariates at their mean.  Within a model, univariate plots (i.e., lines) share a Y-axis scale, enabling direct comparisons of effect sizes among covariates and species.  For bivariate plots, the Y-axis and X-axis reflect the first and second variables listed in the interaction, respectively; colors indicate the direction and magnitude of the partial contribution (blacks = negative, reds = positive; darker colors = larger effect) and are likewise comparable within a model. Northing by easting effects are given only at 31 December. For factor variables, only the general association (i.e., positive or negative) with the additive predictor is given. Covariate abbreviations correspond to Equation 1.

\pagebreak

```{r occupancy_maps, eval=FALSE}
# Figures 3 was created using the following scripts.  However, for nice formatting in the 
# pdf and Word output we simply link to a resized PNG file.
source("../R/NanSound_plot.R")
source("../R/map_occupancy.R")
```
![Sea duck occupancy](./Figures/occupancy_maps_reduced.png)  
**Figure 3.** Median (first row) and median absolute deviation (MAD) relative to median (%; second row) of Common Eider (COEI), scoter (SCOT), and Long-tailed Duck (LTDU) occupancy in Nantucket Sound based on predictions at 10 dates evenly-spaced from 15 November through 1 April in three winters (2003 - 2005).  Predicted values are categorized based on their quartiles; segments with predictions $\geq$ 98th percentile are outlined in black. Occupancy values represent the predicted probability of sea duck presence in a 1.5 km x ca. 180 m transect through the segment.

\pagebreak

```{r conditional_abundance_maps, eval=FALSE}
# Figures 4 was created using the following scripts.  However, for nice formatting in the 
# pdf and Word output we simply link to a resized PNG file.
source("../R/map_conditional_abundance.R")
```
![Sea duck conditional abundance](./Figures/conditional_abundance_maps_reduced.png)  
**Figure 4.** Median (first row) and median absolute deviation (MAD) relative to median (%; second row) of Common Eider (COEI), scoter (SCOT), and Long-tailed Duck (LTDU) conditional abundance in Nantucket Sound based on predictions at 10 dates evenly-spaced from 15 November through 1 April in three winters (2003 - 2005).  Predicted values are categorized based on their quartiles; segments with predictions $\geq$ 98th percentile are outlined in black. Conditional abundance values represent the expected number of sea ducks, conditional on their presence, in a 1.5 km x ca. 180 m transect through the segment.

\pagebreak

```{r overall_abundance_maps, eval=FALSE}
# Figures 5 was created using the following scripts.  However, for nice formatting in the 
# pdf and Word output we simply link to a resized PNG file.
source("../R/map_overall_abundance.R")
```
![Sea duck overall abundance](./Figures/overall_abundance_maps_reduced.png)  
**Figure 5.** Median (first row) and median absolute deviation (MAD) relative to median (%; second row) of Common Eider (COEI), scoter (SCOT), and Long-tailed Duck (LTDU) average abundance in Nantucket Sound based on predictions at 10 dates evenly-spaced from 15 November through 1 April in three winters (2003 - 2005).   Predicted values are categorized based on their quartiles; segments with predictions $\geq$ 98th percentile are outlined. Conditional abundance values represent the expected number of sea ducks in a 1.5 km x ca. 180 m transect through the segment.  The polygon in the northwest corner of Nantucket Sound indicates the location of permitted wind energy development on Horseshoe Shoal.

\pagebreak

```{r compare_abundance, eval=FALSE}
# Figures 6 was created using the following script.  However, for nice formatting in the 
# pdf and Word output we simply link to a resized PNG file.
source("../R/compare_predicted_vs_counted.R")
```
![Compare_abundance](./Figures/Predicted_abundance_observed_abundance.png)  
**Figure 6.** Observed vs. predicted total abundance of Common Eider (COEI), scoter (SCOT), and Long-tailed Duck (LTDU) during 30 aerial surveys of Nantucket Sound.  The dashed line indicates a 1:1 relationship between predicted and observed abundances in surveyed segments; points below and above this line indicate predicted abundances below (underestimateion) and above the observed totals (overestimation), respectively.

\pagebreak

## Discussion (expanded outline)  

**Please suggest places where you feel citations are needed**

We demonstrated a flexible model-based approach to evaluating the environmental associations of animal distribution and abundance based on multiyear replicated surveys.  The boosted GAMLSS framework offered several useful features, including (1) the ability to model all parameters of the conditional distribution (e.g., conditional mean and overdispersion) as a function of covariates, (2) integrated variable reduction and selection among many covariates, and (3) integrated model selection via the simultaneous consideration of competing functional covariate forms (e.g., linear vs. non-linear). Additionally, this framework allowed us to incorporate smooth effects to efficiently account for spatiotemporal trends in the data poorly explained by other covariates and use stability selection to identify those covariates and their functional forms most consistently associated with animal distribution and abundance.  **(Benjamin, anything you'd like to add to this?)**

Boosted GAMLSS models revealed disparate spatiotemporal distributions and abundances of sea duck species in Nantucket Sound.  **More info?** Biophysical associations with sea duck occupancy were relatively consistent among species, although spatial effects dominated and resulted in disparate patterns of occupancy.  Biophysical associations with sea duck conditional abundance were more species-specific but, with the exception of eider, dominated by spatial effects.  **Probably need more detail on relationships here? Anything in particular to focus on?**  Of note is the spatiotemporal heterogeneity in the overdispersion parameter in all species.  This contrasts sharply with the typical assumption in the modeling of counts -- that overdispersion is fixed -- and suggests that in practice it is useful to consider that other parameters of the assumed response distribution vary with covariates (as GAMLSS models allow) and not simply the conditional mean. In other words, certain biophysical or ecological features might influence the abundance of organisms and the variability in their abundance relative to the expectations of the underlying model (negative binomial in this case).

Care must be taken when inferring the generality of associations between sea duck occupancy and abundance. It is implied that our discussion of these biophysical factors applies only at the scale used in this study, which is rather coarser than the scale of sea duck foraging. It has been shown that certain covariates may associate with marine bird abundance or behavior at certain scales and not at others [@Logerwell1996]. Specifically to sea ducks, for example, @Zipkin2010 found the North Atlantic Oscillation important in all these species at a continental scale whereas we found no support at the scale of this study. Our estimates of the spatiotemporal abundance of sea ducks in Nantucket Sound were controlled largely by information on the conditional abundance of sea ducks.  That is, while occupancy plays an important role in describing species distribution, it does not necessarily adequately reflect animal abundance, suggesting that occupancy models alone [e.g., @Winiarski2014; @Flanders2015] may be inadequate for assessing risk from anthropogenic disturbances or describing the distribution of marine species **(or more general)**.

The general agreement between predicted and observed sea duck counts suggested a fit sufficient to extrapolate total sea duck abundance to segments (actually, transects of segments) unobserved in the study area, one of the primary advantages of model-based methods.  Nonetheless, we elected not to extrapolate total abundance estimates of sea ducks to all Nantucket Sound for several reasons. First, sea duck abundance changed dynamically throughout a winter season (e.g., Appendix 9).  This extensive temporal variability in sea duck abundance and distribution is often ignored **(I say this because I rarely see people modeling within-season effects)** as a potential source of variation and may complicate the assessment of anthropogenic effects (e.g., before/after studies) or long-term monitoring programs; **(revise to make intelligible)** for example, potentially something as trivial as inconsistency in the timing of surveys could influence pre/post-impact comparisons or obscure annual trends. Second, that fitted models contained considerable unexplained variation suggested that abundance estimates would contain considerable uncertainty, especially considering that the pseudo-R^2^ measure (1) was estimated from the data used to fit the model [c.f., @Maloney2012] and (2) may be misleading because much of the explanatory power in most models was attributable to marginal spatial effects (i.e., *xkm-ykm* position) and not known biophysical features.  This unexplained variation and the predominance of marginal spatial effects suggested we were likely missing important variable(s) relevant to the distribution of sea ducks or we need better biophysical proxies for dynamic sea duck prey distributions or concurrent prey distribution information [e.g., @Vaitkus2001; @Kaiser2006; @Zydelis2009; @Cervencl2012; @Cervencl2014], although this is typically considerably more difficult to characterize at appropriate scales and does not guarantee improved predictive accuracy [@Torres2008; @Gremillet2008; @Benoit-Bird2013]. Moreover, the importance of strictly spatial covariates complicated the generalization of the model fit to all but the immediate study area. Finally, unknown and unquantified availability bias [e.g., ducks diving during survey; @Marsh1989] possibly resulted in underestimated sea duck occupancy (although we expect aggregating observations into 2.25 km^2^ segments reduced the impact on occupancy) and almost certainly underestimated abundance.  Model predictive ability and generality may be improved by incorporating mechanistic considerations [e.g., @Megrey2007; @Kearney2009; @Smolik2010] relevant to sea ducks and their prey.

**Maybe a paragraph of the possible drawbacks that moves into extensibility?  BENJAMIN: please vet this**  Current drawbacks of the approach include the substantial requisite computing power and time, particularly when precision estimates for the fit are to be derived.  Ditto for generating confidence intervals (and thus approximate tests of significance) for functional relationships, although this is a characteristic of all penalization approaches and stability selection offers a considerably more speedy heuristic to formal tests of significance.  Some difficulty in specifying a good candidate model, i.e., which effects should be included and how? **(BENJAMIN: please elaborate**.  But this framework is also very extensible --- the approach used herein could readily be modified to generate precision estimates of model fits and derived parameters **(BENJAMIN: we need to discuss this more)**, incorporate observation models (i.e., detection functions; distance sampling), use newer smoothing approaches [@Scott-Hayward2013], accommodate double hurdle models that accommodate zero inflation and extreme counts (e.g., so called "double-hurdle"" model; E. Balderama, pers. comm.; see also @Katz2005), and incorporate simple random effects.

## Literature cited