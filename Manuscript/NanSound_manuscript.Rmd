---
title: Nantucket Sound Sea Ducks
author: Adam D. Smith, Benjamin Hofner, Jason E. Osenkowski, Taber Allison, Scott R. McWilliams, and Peter W. C. Paton
date: "`r format(Sys.time(), '%d %B, %Y')`"
header-includes:
  - \usepackage[utf8]{inputenc} 
  - \usepackage[parfill]{parskip}
#  - \usepackage{amsmath}
#  - \usepackage{soul}
#  - \usepackage{graphicx}
#  - \usepackage{caption}
#  - \captionsetup[figure]{labelfont=bf}
output: 
#  pdf_document:
#    pandoc_args: [
#      "--filter", "pandoc-fignos"
#    ]
#    toc: true
#    toc_depth: 3
  word_document:  
fontsize: 12pt
geometry: margin=1in
number_sections: true
documentclass: article
bibliography: NantucketMS.bib
csl: ecology.csl
---

```{r chunk-opts, echo=FALSE}
# Set some knitr chunk options
options(width = 250, scipen=999)
knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE, 
               fig.path="./Rpubs/figs/", 
               cache.path="./Rpubs/cache/")
```

```{r load-options-data}
# Aliases and functions
# Requires devtools package to be installed
devtools::source_gist(9216051) # Rprofile.R
devtools::source_gist(9216061) # various.R

# Necessary packages; other packages may be loaded as other files are sourced
toLoad = c("Hmisc", "ggplot2", "grid", "gridExtra", "rgdal", "lubridate",
           "reshape", "plyr", "dplyr", "gamlss.tr", "gamboostLSS")
instant_pkgs(toLoad); rm(toLoad)

# Load sea duck data sets
# This includes:
#   env.segs - environmental data from all (504) segments on all (30) survey dates; includes
#              field (length) that indicates the amount of survey effort (if any) on a given
#              date
#   obs.final - segment level count summaries for each species/group
load("../Data/ducks&environment.RData")

# For each group, load/create data sets for various analyses
# This creates the (1) final survey data set (e.g., coei), (2) zero-truncated
#   data set (i.e., at least 1 duck observed; e.g., coei_zerotrunc), and 
#   (3) presence/absence data set (e.g., coei_zero) 
source("../R/load_sea_duck_data.R")

# Loading & renaming the sea duck occupancy and hurdle models
# Note, loading the sea duck models will not work with Github given file size limitations
# At present, it accesses the models stored on the local drive
# Can we store the files online somewhere and access them that way? Dryad?
source("../R/load_sea_duck_models.R") # takes a couple of minutes

# Load predict function for combined occupancy/count models
source("../R/predict.gamlssHurdle.R")
```

```{r get_predictions, eval=FALSE}
# For each group, create data for prediction
# This does two important things: (1) creates the final data set over which 
#   model predictions are desired (e.g., coei_pred) and (2) calculates the average
#   of relevant variables (covar_avgs) so that partial effect plots can be placed
#   on their original scale for easier interpretation
source("../R/create_new_data.R")
source("../R/predict_from_new_data.R")

# To save time, we alternatively provide the products of this process: 
#   coei_final, scot_final, ltdu_final
load("../Data/prediction_data.Rda")
```

**If we're aiming for Ecological Applications, we should frame the manuscript as equal parts ecology and methodology.  However, I think making the case that our approach is the BEST is unnecessary (and is likely much more work).**

Biophysical features at multiple spatial and temporal scales affect the distribution and abundance of vertebrates and their prey (**general citations; any suggestions?**). Despite increasing anthropogenic impacts on marine ecosystems (**citations; any suggestions**), the environmental factors associated with the distribution and abundance of sea ducks (Tribe Mergini), top consumers in these ecosystems, are notably understudied.  Moreover, current evidence suggests that populations of most species of North American sea ducks are below historic levels with negative or indeterminate (given current data) population trends [@Merkel2004; @Bowman2015].  Thus there exists considerable interest in identifying the biophysical characteristics of the marine environment that influence the distribution and abundance of sea ducks.

At macro-scales (e.g., wintering range), large-scale ocean characteristics [e.g., @Flint2013], climatic conditions [e.g., @Zipkin2010], and static or persistent habitat features [e.g., bathymetry, substrate, current and frontal systems; @Hyrenbach2000] typically associate with large-scale patterns in distribution of marine birds [e.g., @Nur2011].  At the micro- and meso-scales of acute anthrogenic disturbances (e.g., energy development, oil spills, fisheries), however, the abundance and distribution of prey, and thus predators, can be extremely ephemeral and dynamic [@Hyrenbach2000; @Ortega2011], even relating to prevailing meteorologic conditions [e.g., @Garthe2009], potentially hindering the utility of static or persistent biophysical covariates (or those measured too coarsely in time or space; **e.g. human activity such as ferry/fisheries/etc.?**).  Marine birds (sea ducks) distribution is patchy (**citations**); abundance can be extremely variable; often interested in evaluating the relevance of many potential covariates with possibly complex (i.e., nonlinear) associations with animal presence and abundance (**citations**).  

Consequently, assessing anthropogenic effects on the distribution and abundance of marine birds requires a flexible approach to accommodate potentially complex animal distibutions, associations with environmental covariates.  Model-based approaches [cf. design-based approaches; @Borchers2002] provide this flexibility and, given an appropriate model, facilitate the spatially-explicit estimation of animal abundance in unsampled area and the detection of changes in animal distribution independent of abundance [e.g., @Certain2008; @Nur2011; @Kinlan2012; @Winiarski2014; **include CREEM guidance doc?**].  We implemented generalized additive models [GAMs; @Hastie1990; @Wood2006] and their recent extension [GAM for location, scale, and shape; GAMLSS; @Rigby2005] in a gradient descent boosting framework [@Hothorn2010; @Mayr2012; @Hofner2015b] to evaluate the distribution and abundance of sea ducks in Nantucket Sound, Massachusetts, USA.  GAMLSS methods extend GAMs to allow all parameters of the conditional response distribution to be modeled as a function of relevant covariates [@Rigby2005]; this approach thus grants insight not only into the covariates associated with sea duck distribution and abundance but also their variability.  Moreover, the model-based boosting algorithm accommodates the inclusion of various effect types [e.g., linear, smooth, spatial, spatiotemporal, and random effects; @Hofner2014] and correlated covariates (i.e., parameter estimates are regularlized), identifies the most relevant subset among potentially many covariates (i.e., variable selection), and evaluates competing representations of continuous covariates [e.g., linear vs. nonlinear effects of covariates; @Kneib2009; @Maloney2012].

##Methods

*Aerial strip transect surveys.*---We conducted aerial surveys throughout an 1,100 km^2^ study area in Nantucket Sound, Massachusetts, USA (Figure 1).  Nantucket Sound is an important wintering area for sea ducks in southern New England [@White2009; @Silverman2013; @Loring2014].  Wind energy development has been fully permitted on 62 km^2^ of Horseshoe Shoal in the northwest portion of the study area (Figure 1). During the winters (late October to mid-April) of 2003-2005, we conducted 30 (2003/2004: 13, 2004/2005: 10, 2005/2006: 7) aerial strip-transect surveys [e.g.,@Pollock2006; @Certain2008] to evaluate sea duck distribution and relative abundance; surveys occurred primarily from November - March (n = 27), with an occasional October (n = 1) or April (n = 2) survey.  During each survey, we flew along 15 parallel (ca. 2.3 km apart), roughly north-south transects (Figure 1) using a high-wing, twin-engine aircraft (Cessna Skymaster 337) at an average altitude of 152 m and speed of 167 kmh^-1^ (90 kts). This altitude allowed us to identify most birds at the sea surface and reduced sea disturbance (i.e., flushing birds to another part of the study area and, thus, potential double counting). The airspeed was the slowest at which the aircraft could safely fly. Surveys occurred only on days with wind speeds $\leq$ 15 kts and good visibility (>15 km). Surveys occurred between 0900 to 1600 h (average duration of ~ 2.5 h) to ensure that birds had completed their post-dawn movements [e.g., @Davis1997] but had yet to initiate pre-sunset movements from feeding to roosting areas; this time window also reduced glares due to low sun angles.

On each survey flight, two observers used their unaided eyes to continuously detect individuals or flocks, identifying sea ducks to species with the aid of binoculars as needed. Observers monitored the sea surface on their side of the plane in a ~ 90 m wide transect between ~ 56 - 147 m from the plane; observers could not see beneath the plane out to 56 m on each side. The narrow strip width ensured birds were detectable and identifiable with the naked eye and allowed us to avoid situations in which ducks were too abundant or spread over too wide an area to count accurately. This last point was especially relevant because sea ducks occasionally congregated in extremely large aggregations. **(Should we mention return visits and photographs used to inform estimation of large rafts?)**  We thus assumed inconsequential perception bias [i.e., few missed individuals present to be counted; @Marsh1989] given that our flight altitude and narrow transect width  [e.g., @Certain2008] within the strip transect [@Buckland2012]. 

Observers verbally communicated duck sightings to a recorder, who entered the number of ducks, species, behavior (i.e., on the water or flying), and geographic location into a laptop computer linked to the plane's onboard GPS; we report results only from ducks observed sitting on the water. Sea duck species of interest included Common Eider (*Somateria  mollissima*; hereafter eider), White-winged Scoter (*Melanitta deglandi*), Surf Scoter (*M. perspicillata*), Black Scoter (*M. americana*), and Long-tailed Duck (*Clangula hyemalis*). We considered scoter species collectively (hereafter, scoter), as it was regularly difficult to identify scoter to species. We subsequently consolidated counts for each species (eider and Long-tailed Duck) or species group (scoter) into 2.25km^2^ segments (Figure 1); this resolution (1.5 km x 1.5 km) corresponded approximately to the coarsest level of resolution of biophysical covariates (see below).

```{r studyarea, eval=FALSE}
# Figure 1 was created using the following script, although for nice formatting
# in the pdf and Word output we simply link to the final PNG file, below
source("../R/map_study_area.R")
```
![Nantucket Sound study area](./Figures/Nantucket_study_area_reduced.png)  
**Figure 1.** Aerial strip transects (gray lines; n = 30) for sea ducks during the winters (October - April) of 2003 - 2005 in Nantucket Sound, Massachusetts, US. The grid indicates the extent of the study area and its division into 504 2.25km^2^ segments. The polygon in northwest Nantucket Sound indicates the location of permitted wind energy development on Horseshoe Shoal.

*Modeling approach.*---We related spatiotemporal variation in sea duck occupancy (i.e., probability of presence) and abundance to potentially relevant biophysical and spatiotemporal covariates. We applied a negative binomial hurdle model that separately modeled (1) the probability of occurrence of at least one individual (hereafter, the occupancy model) in a given segment using a logistic regression model and (2) the abundance of sea ducks in that segment conditional on their presence (hereafter, the count model) using a truncated negative binomial model. The prevalence of zero counts (e.g., `r round(100 * nrow(coei[coei$count == 0,])/nrow(coei))`% of eider segment observations) prompted the use of a hurdle model. We generated separate hurdle models for each sea duck group [i.e., eider, scoter, and Long-tailed Duck; @Zipkin2010].

To model sea duck occupancy, we used a generalized additive model [GAM; @Hastie1990; @Wood2006] that flexibly accommodated potential nonlinearities between covariates and sea duck occupancy.  We used generalized additive models for location, scale, and shape [GAMLSS; @Rigby2005] to fit the count models; these models accommodated potential nonlinearities between covariates and the conditional mean and overdispersion of sea duck abundance. 

We implemented GAMs and GAMLSS in a gradient descent boosting framework [@Mayr2012; @Hofner2015b]. More specifically, we used component-wise functional gradient descent boosting to fit the models.  Briefly, one begins by computing the negative gradient of a user-specified loss function; the loss function usually equals the negative log-likelihood of the underlying model and the negative gradient can be viewed as a proxy for residuals. We used the negative binomial log-likelihood as the loss function for occupancy models and the (negative) truncated negative binomial log-likelihood as the loss function for count models. In the next step, all modeling alternatives [i.e., functional forms of the covariates relative to the response, called base-learners; @Hofner2014) are fitted separately to the negative gradient and a fraction of the best fitting base-learner is added to the current model fit. The negative gradient is then reevaluated at the current model fit and the procedure iterated until for a fixed number of iterations, *$m_\text{stop}$*, specified by the user [see @Buhlmann2007 for additional details]. Boosted GAMLSS models are fitted similarly, although in each iteration the negative gradient is computed separately with respect to each GAMLSS parameter (e.g., mean and overdispersion) while holding other parameters as fixed constants.  Base-learners are then fitted to the resulting parameter-specific negative gradient vector and model updates are computed separately for each GAMLSS parameter as for boosted GAMs [see @Mayr2012 for additional details].

As only the single best-fitting base-learner is selected in each iteration, the algorithm thus integrates intrinsic selection of the most relevant covariates and their functional form (i.e., some base-learners may never be selected).  Variable selection is further fostered  by stopping the algorithm prior to convergence to maximum likelihood estimates [early stopping; @Mayr2012; @Maloney2012]. Furthermore, early stopping aims at maximizing predictive accuracy while avoiding model overfitting.  We used 25-fold subsampling to determine the optimal stopping iteration for each model.  Specifically, we randomly drew (without replacement) 25 samples of size $n/2$ from the original data set. We used the selected sample to estimate the model and the balance of the data in each sample to determine the out-of-bag prediction accuracy (empirical risk) measured by the negative log-likelihood of each model; the optimal stopping iteration ($\hat{m}_\text{stop}$) is the iteration with the lowest average empirical risk. In boosted GAMLSS models we used multi-dimensional subsampling to determine the stopping iteration for each of the GAMLSS parameters while allowing for potentially different model complexities in the parameters; a detailed explanation of this cross-validation (subsampling) scheme is given in @Hofner2014b.

Despite these agreeable features, boosting methods typically produce "rich" models relying to some extent on many base-learners [@Hofner2015a].  Thus, we additionally applied stability selection [@Meinshausen2010; @Shah2013] to identify those base-learners, and thus covariates, most commonly selected in each model (i.e., selected on the majority of 100 random subsamples of the data); see Appendix 1 and @Hofner2015b for more details.

*Covariates.*---We evaluated biophysical covariates expected to influence the distribution and availability of benthic prey or the distribution, abundance, and movements of sea ducks (see Appendix 2*, a not yet completed table defining covariates and their abbreviations as used in the model specification*). We did not have information related directly to the distribution of preferred prey (e.g., mollusks and crustaceans).  Biophysical covariates could be characterized as strictly spatial or temporal effects (i.e., varying only among segments or within or among winters, respectively) or as spatiotemporal effects (i.e., varying among segments and within or among winters; see Appendix 2). Additionally, we included interactions that allowed the effects of two covariates to vary over time within a given winter (see Appendix 2).  We standardized (i.e., mean centered and scaled) all continuous covariates.

For each continuous covariate, we specified two base-learners: a linear base-learner and a penalized nonlinear base-learner [i.e., P-splines; @Eilers1996; @Schmid2008].  We dummy-coded categorical covariates, resulting in *K* - 1 linear base-learners for a *K*-level covariate.  To address potential spatial autocorrelation, we included a smooth surface function of the spatial coordinates of segment centers [@Kneib2008]; this surface comprised four base-learners -- linear base-learners for the easting *x* and northing *y*, their linear interaction, and a penalized nonlinear tensor product P-spline [@Kneib2008; @Kneib2009; @Maloney2012].  We also allowed this surface to vary over (interact with) time within a winter.  @Hofner2014 describe base-learners in detail. 

The decomposition of continuous covariates into centered linear and penalized orthogonal nonlinear base-learners allowed us to weight base-learners equally allow unbiased model choice [i.e., to prevent the preferential selection of smooth base-learners; @Kneib2009; @Hofner2011].  Specifically, we restricted each base-learner to a single degree of freedom and omitted the intercept term from each base-learner [@Kneib2009; @Hofner2011].  Consequently, we added an explicit linear base-learner for the model intercept. The occupancy and count models had the following structure (see Appendix 2 for descriptions of abbreviated covariates):

\begin{equation}
\begin{aligned}
g(\cdot) =  & int + time + f(time) + SSTw + f(SSTw) + SSTm + f(SSTm) + SSTrel +\\
     & f(SSTrel) + SSTrel \cdot time + f(SSTrel, time) + SBT + f(SBT) + NAOw + \\
     & depth + f(depth) + depth \cdot time + f(depth, time) + d2land + f(d2land) +\\
     & chla + f(chla) + cdom + f(cdom) + f(cdom, chla) + meanphi + f(meanphi) +\\
     & SAR + f(SAR) + tidebmean + f(tidebmean) + tidesd + f(tidesd) + strat +\\
     & f(strat) + ferry + y2004 + y2005 + xkm + ykm + xkm \cdot ykm + \\
     & f(xkm, ykm) + xkm \cdot time + ykm \cdot time + xkm \cdot ykm \cdot time + \\
     & f(xkm, ykm) \cdot time + obs\_window + f(obs\_window).  
\end{aligned}
\end{equation}

In our occupancy models, $g(\cdot)$ is $g(\pi_{\text{sea ducks}})$, the occupancy probability of a given duck species in a segment and $g$ is the logit link.  In our count models, $g(\cdot)$ took two forms within the GAMLSS framework -- the (conditional) mean count of sea ducks, $g(\mu_{\text{sea ducks}})$, and the (conditional) overdispersion in sea duck counts, $g(\sigma_{\text{sea ducks}})$; $g$ is the log link in both cases.  Base-learners denoted as $f(\cdot)$ indicate the penalized nonlinear deviations from the corresponding linear base-learner (e.g., $f(time)$). The explicit intercept (*int*) was a necessary byproduct of our decomposition of base-learners [see above; @Kneib2009; @Hofner2011].  Small values of *obs_window*, our measure of survey effort (see Appendix 2), in some segments impaired the estimability of models including *obs_window* as an offset; we thus included it as a covariate.

**Where to put this:** However, because of unknown and unquantified availability bias [e.g., ducks diving during survey; @Marsh1989], we almost certainly underestimated sea duck occupancy and, in particular, abundance; the effects on occupancy were likely reduced given the aggregation of observations into 2.25 km^2^ segments.

To evaluate the approximate explanatory power of our final models, we calculated a pseudo *R*^2^ measure of the explained variation [@Nagelkerke1991; @Maloney2012]. **Benjamim: I think I've correctly adapted Maloney et al.'s [-@Maloney2012] code; see pseudoR2.R.  I calculate the pseudo R^2^ only from final model rather than multiple times in bootstrap samples.  Can you possibly check my calculations of the log-likelihoods?**

All analyses were conducted in R [Version 3.1.3; @RCoreTeam2014] with the add-on packages gamboostLSS [@Hofner2015b], mboost [@Hothorn2015], and stabs [@Hofner2015].  The data and code for reproducing this manuscript and analyses are given as an online electronic supplement at *TBD*.

## Results

As the occupancy and the hurdle model are independent, we fitted two models per sea duck species. Bootstrapped empirical risk suggested that occupancy models for all species converged on the maximum likelihood estimates (i.e., occupancy models failed to stop early; see Appendix 4).  Failure to stop early sometimes happens in data sets with many observations and strong but complex effects (**Benjamin: citation for this, or pers. obs?**). This suggests that the effects of the environmental variables on sea duck occupancy are rather complex. Conversely, bootstrapped empirical risks prescribed early stopping for both parameters (i.e., conditional mean and overdispersion) in all count models (see Appendix 4).  Consequently, final occupancy models generally contained more covariates than did count models, particularly among stably selected covariates.  Nonetheless, we obtained sparse models that included only a subset of the initially specified base-learners.  Specifically, occupancy and count (conditional mean) models contained only 12% to 38% of the 48 base-learners available for selection, translating to 3 and 10 of 23 covariates of interest, respectively (Figure 2). **(Should I indicate which models correspond to these numbers?  If so, they are Long-tailed Duck conditional abundance and scoter occupancy, respectively)** 

```{r evaluate_models, eval=FALSE, cache=TRUE}
source("../R/pseudoR2.R")
(COEI_r2 <- round(pseudoR2(COEIocc, COEIcc, coei, engine = "pscl"), 2))
(SCOT_r2 <- round(pseudoR2(SCOTocc, SCOTcc, scot, engine = "pscl"), 2))
(LTDU_r2 <- round(pseudoR2(LTDUocc, LTDUcc, ltdu, engine = "pscl"), 2))
```

**Where is the best place to mention model predictive ability/fit measures:** Final predictive models explained moderate amounts of variation in observed counts of eider, scoter, and Long-tailed Duck (pseudo *R*^2^ = 0.31, 0.48, and 0.32, respectively).  

**Scott/Peter: consider when reading these next sections how much to wax about selected covariates and the form of their associations with occupancy/abundance.  I vote for not going _very_ far down the ecological rabbit hole.  We should _not_ view these as hypothesis tests, but could nonetheless comment (in the discussion) about whether these effects are interesting or non/confirmatory with current knowledge. Currently, I point out the most important variables and occasionally provide some basic commentary.**

*Sea duck occupancy.*---More covariates were consistently selected as stable in occupancy models relative to conditional count models (Figure 2).  However, the suite of stably selected covariates associated with occupancy was relatively consistent among sea duck species (Figure 2; Appendices 5 - 7 contain detailed covariate plots for eider, scoter, and Long-tailed Duck, respectively).  Spatiotemporal effects (i.e., occupancy associated with the *x-y* location of segments and the change over time within winter) were the dominant explanatory feature in sea duck occupancy models, although the spatiotemporal patterns of occupancy varied considerably among species (Figure 2).  **Scott/Peter: this suggests we're missing some important variable(s) relevant to the distribution of sea ducks or their prey, or we have a problem in the model separating spatial effects and environmental effects with a strong spatial structure (this seems less likely, given the relatively distinct pattern for each species).  Of course, there's also the possibility that the actual survey data are flawed somehow.**  Sea duck occupancy increased, but at a decreasing rate, with survey effort in a given segment (Figure 2).  Among biophysical covariates, sea duck occupancy increased at intermediate monthly sea surface temperature (*SST~m~*), particularly (and at somewhat warmer temperatures) in Long-tailed Ducks.  Sea duck occupancy also increased modestly at greater distances from land **(does this count as a biophysical covariate?)**, although eider occupancy was lowest at intermediate distances (i.e., eider occupancy also increased in the nearshore).  Eider and scoter occupancy was greater in areas with coarser sediments (i.e., smaller *meanphi*), but the effect was more dramatic for eider (Figure 2).  Furthermore, eider occupancy associated negatively with chromomorphic dissolved organic material (*CDOM*) and positively with sea floor surface:planimetric area (*SAR*), our measure of sea floor "roughness" (Figure 2); scoter occupancy likewise related to *SAR* and *CDOM*, but in the opposite direction in both cases (Figure 2).  Scoter occupancy was modestly greater in deeper waters; Long-tailed Duck occupancy was greatest in shallow waters early in the winter but in deeper waters later in the winter (Figure 2).  Other effects were relatively minor and inconsistent among species. 

Spatially-explicit maps of median occupancy over the course of the study (Figure 3, top row) illustrate the dominant influence of strictly spatial (i.e., segment *x-y* location) effects (Figure 2). The result is quite distinct patterns of occupancy among species despite the relative similarity of occupancy associations with biophysical covariates (Figure 2).  **I don't know if it's worth going on too much here about patterns of occupancy; the most interesting pattern, I think, is that of average abundance that combines occupancy and conditional abundance (Figure 5).  That, and the point that while patterns of occupancy broadly reflect patterns of average abundance, information on abundance strongly affects the overall pattern of sea duck distribution (we should probably highlight [or at least return to] this in discussion).  But, is it worth noting some general similarities/differences, such as:** notable overlapping areas of relatively high occupancy in northeast quadrant of Nantucket Sound, and all species relatively avoided the middle western edge (northeast of Martha's Vineyard; see Figure 1)?  Generally, the areas of highest occupancy exhibited the lowest relative variability (Figure 3, bottom row), defined as the median absolute deviation (MAD) of occupancy relative to median occupancy within a segment (a measure analogous to the coefficient of variation).

*Sea duck conditional abundance and overdispersion.*---In contrast to occupancy, fewer covariates associated consistently with the abundance of sea ducks, conditional on their presence, and the suite of stably selected effects varied more markedly among sea duck species  (Figure 2; Appendices 5 - 7 contain detailed covariate plots for eider, scoter, and Long-tailed Duck, respectively).  However, selected variables tended to fall within the suite of covariates selected in occupancy models.  The primary exception to this pattern is the apparent increase in eider and scoter abundance, conditional on presence **(need I say this repeatedly?)**, in segments with relatively warm or cool sea surface temperatures (*SST~rel~*; Figure 2).  In scoter and Long-tailed Duck, spatiotemporal effects were again the dominant explanatory feature, although they were not selected in the eider model (Figure 2).  **(should we recycle anything from the discussion above regarding spatial effects?)**  For a given species, biophysical covariates selected in occupancy and count models exhibited broad agreement, with the exception of sediment grain size (*meanphi*) in scoter and more complex relationships between eider abundance and chromomorphic dissolved organic material (*CDOM*) and sea floor surface:planimetric area (*SAR*; Figure 2).

**Do you think it's worth talking about the similarities/differences among species in conditional abundance maps?  Personally I don't see much point; what seems most relevant is the combined occupancy/count model (see next section).  The only possibly worthwhile comparison is patterns of conditional abundance vs. occupancy - i.e., sometimes they agree, whereas in other areas occupancy is lower but ducks, when present, are more abundant (e.g., scoter in southwest Nantucket Sound; COEI in the eastern portion of Nantucket Sound) or vice versa (e.g., COEI in the Horseshoe Shoals area).  If we go this route, I would suggest doing so only for the conditional abundance (see current Figure 4) and reserve overdispersion for an appendix (as I do now).  Your thoughts?  Otherwise, we could note that conditional abundance goes a long way towards determing patterns of overall abundance (next section) and relegate Figure 4 to an appendix with conditional overdispersion.**

Overdispersion in conditional sea duck abundance also varied with (typically fewer) biophysical covariates; there was little consistency in the covariates that influenced overdispersion among species (Figure 2; Appendices 5 - 7 contain detailed covariate plots for eider, scoter, and Long-tailed Duck, respectively).  **Rather than belabor the relationships, I think we should emphasize the primary result that** variability (i.e., overdispersion) in sea duck counts was heterogeneous in the study area; this contrasts with the typical assumption in overdispersed (negative binomial) coutn models -- that overdispersion is fixed -- and highlights that this assumption does not always hold in practice and that it thus can be useful to consider that other parameters of the distribution (e.g., the overdispersion parameter) and not simply the conditional mean, depend on covariates.  In other words, and in cases similar to the current study, certain biophysical/ecological features might influence the abundance of animals/organisms and the variability in those counts relative to the expectations of the underlying model (negative binomial in this case).  Spatially-explicit maps of conditional overdispersion in the study area are provided in Appendix 8.

**Where/if to put this:** The MAD/median maps highlight something important but perhaps not obvious -- that our spatially-explicit estimates of occupancy, abundance, and overdispersion invariably change over time, either explicitly via the selection of a within- or among-season time effect (*time* and *y2004*/*y2005*, respectively) or implicitly via the selection of biophysical covariates that change within or among seasons.  In fact, the dynamics of the system are one of its most striking attributes, and potentially complicate the assessment of anthropogenic effects.  Appendix 9 illustrates the dynamic nature of occupancy and average abundance in Nantucket Sound using data from scoter during the 2005 winter as an example.**
 
*Expected sea duck abundance.*---Consolidating the occupancy and conditional count models [see, e.g., Equation 6 in @Zeileis2008] allowed us to estimate expected (average) sea duck (relative) abundance in the study area over the survey period (Figure 5, top row).  Conditional abundance (Figure 4, **or appendix, depending**) strongly influenced the spatially-explicit patterns of average abundance.  Sea duck species exhibited relatively distinct patterns of abundance in Nantucket Sound.  **Here I think we can spend some time describing species-specific patterns, such as:**  Eider were most abundant, and relatively consistently so over time, in southwestern Nantucket Sound (Figure 5); eider were also relatively abundant in northeastern part of the sound, but less consistently so as evidenced by the relatively high MAD/median abundance over time (Figure 5).  Scoter were also most abundant, occasionally extremely so, in southwestern Nantucket Sound, although this was also the area of highest relative variation in scoter abundance (Figure 5); relatively high abundances of scoter also occurred in interior Nantucket Sound (Figure 5).  Long-tailed Ducks were consistently most abundant in northeastern Nantucket Sound, as well as along its southern margin (Figure 5).  No species exhibited their highest abundances in the permitted Nantucket Shoal area, although eider and scoter abundances were consistently elevated in some parts of the Shoal (west and southeast, respectively; Figure 5).  **What else should we mention here?**  

\pagebreak
```{r covariate_plot, eval=FALSE}
# Figure 2 was created using the following script, although some manual editing
# was required to add model column headings.  For nice formatting in the pdf and Word
# output we simply link to the final PNG file, below.
source("../R/assemble_covariate_plot.R")
```
![Covariate effect plot](./Figures/Covariate_effects.png)  
**Figure 2.** Marginal functional plots for stably selected covariates in the occupancy (probability of presence) and conditional abundance (mean and overdispersion parameters) of Common Eider (COEI), scoter (SCOT), and Long-tailed Duck (LTDU) in Nantucket Sound during winters 2003 - 2005.  estimates show relationships between a response and any predictor variable after accounting for all other covariates.Partial effects (i.e., covariate effect with all others at their mean)  Within a model, the magnitude of univariate effects (i.e., lines) is comparable among covariates and species.  For bivariate plots, the Y-axis and X-axis reflect the first and second variables listed in the interaction, respectively; colors indicate the direction and magnitude of the linear predictor (blacks = negative, reds = positive; darker colors = larger effect) and are comparable within a model (i.e., among covariates and species). Northing by easting effects are given only at 31 December although these spatial effects regularly changed over time. For factor variables, only the general association (i.e., positive or negative) with the additive predictor is given.
\pagebreak
```{r occupancy_maps, eval=FALSE}
# Figures 3 was created using the following scripts.  However, for nice formatting in the 
# pdf and Word output we simply link to a resized PNG file.
source("../R/NanSound_plot.R")
source("../R/map_occupancy.R")
```
![Sea duck occupancy](./Figures/occupancy_maps_reduced.png)  
**Figure 3.** Median (first row) and median absolute deviation (MAD) relative to median (%; second row) of Common Eider (COEI), scoter (SCOT), and Long-tailed Duck (LTDU) occupancy in Nantucket Sound based on predictions at 10 dates evenly-spaced from 15 November through 1 April in three winters (2003 - 2005).  Predicted values are categorized based on their quartiles; segments with predictions $\geq$ 98th percentile are outlined. Occupancy values represent the predicted probability of sea duck presence in a 1.5 km x ca. 180 m transect through the segment.

\pagebreak
```{r conditional_abundance_maps, eval=FALSE}
# Figures 4 was created using the following scripts.  However, for nice formatting in the 
# pdf and Word output we simply link to a resized PNG file.
source("../R/map_conditional_abundance.R")
```
![Sea duck conditional abundance](./Figures/conditional_abundance_maps_reduced.png)  
**Figure 4.** Median (first row) and median absolute deviation (MAD) relative to median (%; second row) of Common Eider (COEI), scoter (SCOT), and Long-tailed Duck (LTDU) conditional abundance in Nantucket Sound based on predictions at 10 dates evenly-spaced from 15 November through 1 April in three winters (2003 - 2005).  Predicted values are categorized based on their quartiles; segments with predictions $\geq$ 98th percentile are outlined. Conditional abundance values represent the expected number of sea ducks, conditional on their presence, in a 1.5 km x ca. 180 m transect through the segment.

\pagebreak
```{r overall_abundance_maps, eval=FALSE}
# Figures 5 was created using the following scripts.  However, for nice formatting in the 
# pdf and Word output we simply link to a resized PNG file.
source("../R/map_overall_abundance.R")
```
![Sea duck overall abundance](./Figures/overall_abundance_maps_reduced.png)  
**Figure 5.** Median (first row) and median absolute deviation (MAD) relative to median (%; second row) of Common Eider (COEI), scoter (SCOT), and Long-tailed Duck (LTDU) average abundance in Nantucket Sound based on predictions at 10 dates evenly-spaced from 15 November through 1 April in three winters (2003 - 2005).   Predicted values are categorized based on their quartiles; segments with predictions $\geq$ 98th percentile are outlined. Conditional abundance values represent the expected number of sea ducks in a 1.5 km x ca. 180 m transect through the segment.  The polygon in the northwest corner of Nantucket Sound indicates the location of permitted wind energy development on Horseshoe Shoal.

\pagebreak

## Literature cited