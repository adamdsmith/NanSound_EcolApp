---
title: 'Modeling spatiotemporal abundance of mobile wildlife in highly variable environments using boosted GAMLSS hurdle models'  
output:
  pdf_document:
    includes:
      in_header: preamble.tex
      # after_body: supplemental.pdf
fontsize: 12pt
documentclass: article
bibliography: NantucketMS.bib
csl: methods-in-ecology-and-evolution.csl
---

```{r chunk-opts, echo=FALSE}
# Set some knitr chunk options
options(width = 250, scipen=999)
knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE)
```


```{r load-data, include = FALSE}
if (!requireNamespace("pacman", quietly = TRUE)) install.packages("pacman")
source("../R/utils.R")
pacman::p_load(plyr, dplyr, lubridate)
# Need a function from Hmisc but don't want it masking fxns in other packages
if (!requireNamespace("Hmisc", quietly = TRUE)) install.packages("Hmisc")

# Load sea duck data sets
# For each species/species group, load data sets for various analyses
# This creates the (1) final survey data set (e.g., coei), (2) zero-truncated
#   data set (i.e., at least 1 duck observed; e.g., coei_zerotrunc), and 
#   (3) presence/absence data set (e.g., coei_zero) 
source("../R/load_sea_duck_data.R")
```
\doublespacing

Adam D. Smith^1,6^, Benjamin Hofner^2,7^, Juliet S. Lamb$^{1*}$, Jason E. Osenkowski^3^, Taber Allison^4^, Giancarlo Sadoti^5^, Scott R. McWilliams^1^, and Peter W. C. Paton^1^

\bigskip

^1^ *Department of Natural Resources Science, University of Rhode Island, Kingston, Rhode Island 02881 USA*

^2^ *Department of Medical Informatics, Biometry and Epidemiology, Friedrich-Alexander-University Erlangen-Nuremberg, Waldstraße 6, 91054 Erlangen, Germany*

^3^ *Rhode Island Department of Environmental Management, 77 Great Neck Road, West Kingston, Rhode Island 02892 USA*

^4^ *American Wind Wildlife Institute, 1110 Vermont Avenue, NW, Suite 950, Washington, D.C. 20005 USA*

^5^ *Department of Geography, University of Nevada, Reno, Nevada, 89557 USA*

^6^ *Present address: United States Fish and Wildlife Service, National Wildlife Refuge System, Inventory and Monitoring Branch, 135 Phoenix Rd., Athens, GA 30605 USA; avianmigration@gmail.com*

^7^ *Present address: Section Biostatistics, Paul-Ehrlich-Institut, Paul-Ehrlich-Straße 51-59, 63225 Langen, Germany*

$^{*}$ *Corresponding author e-mail: jslamb@uri.edu*


\newpage
\doublespacing

**Abstract**

1. Modeling organism distributions from survey data involves numerous statistical challenges, including accounting for zero-inflation, overdispersion, and selection and incorporation of environmental covariates. In environments with high spatial and temporal variability, addressing these challenges often requires numerous assumptions regarding organism distributions and their relationships to biophysical features. These assumptions may limit the resolution or accuracy of predictions resulting from survey-based distribution models.

2. We propose an iterative modeling approach that incorporates a negative binomial hurdle, followed by modeling of the relationship of organism distribution and abundance to environmental covariates using generalized additive models (GAM) and generalized additive models for location, scale, and shape (GAMLSS). Our approach accounts for key features of survey data by separating binary (presence-absence) from count (abundance) data, separately modeling the mean and dispersion of count data, and incorporating selection of appropriate covariates and response functions from a suite of potential covariates while avoiding overfitting. 

3. We apply our modeling approach to surveys of sea duck abundance and distribution in Nantucket Sound (Massachusetts, USA), which has been proposed as a location for offshore wind energy development. Our model results highlight the importance of spatiotemporal variation in this system, as well as identifying key habitat features including distance to shore, sediment grain size, and seafloor topographic variation. 

4. Our work provides a powerful, flexible, and highly repeatable modeling framework with minimal assumptions that can be broadly applied to the modeling of survey data with high spatiotemporal variability. Applying GAMLSS models to the count portion of survey data allows us to incorporate potential overdispersion, which can dramatically affect model results in highly dynamic systems. Our approach is particularly relevant to systems in which little a priori knowledge is available regarding relationships between organism distributions and biophysical features, since it incorporates simultaneous selection of covariates and their functional relationships with organism responses.

\bigskip

**Key-words**: distribution, GAM, gradient descent boosting, hurdle models, Nantucket Sound, sea ducks, surveys 

\newpage

## Introduction

Understanding how the spatial distribution and abundance of an organism responds to biophysical features is fundamental to many aspects of ecology and conservation [@SchroderSeppelt2006]. Since continuous sampling of the entire range or population of a species is usually impossible, distribution mapping typically involves a series of steps that include surveying a representative subset of the area or population of interest at various time periods, fitting models to represent the relationships of observed data to environmental covariates, using these models to predict utilization of un-sampled areas or time periods based on biophysical habitat features, and finally validating predictions with on-the-ground observations [@BorchersEtAl2002; @CertainBretagnolle2008; @NurEtAl2011; @KinlanEtAl2012]. Although such model-based approaches are widely used, their implementation requires addressing complex statistical challenges [@GuisanThuiller2005], particularly for mobile organisms whose distributions and habitat requirements may vary in space and time [@RungeEtAl2014]. 

Spatiotemporal variability and uncertainty surrounding both the distribution of a species and key environmental covariates represent frequent challenges to the development of predictive models. Landscape- or population-scale occupancy models may lack sufficient resolution to accurately address small-scale spatial variation in habitat use; conversely, small-scale models may be too precise to apply across landscapes [@Johnson1980; @JohnsonEtAl2004; @JohnsonEtAl2006]. Error can be introduced by spatial or temporal mismatches between occurrence estimates, environmental variables, and questions of interest [@GuisanThuiller2005; @AustinVanNiel2011; @MainaliEtAl2015]. In addition to variability, uncertainty surrounding the biotic and abiotic factors determining the distribution of a species can also limit the development and implementation of model-based distribution estimates [@Thuiller2004]. Because a priori knowledge of how occupancy and abundance relate to biophysical features is often lacking, survey data themselves can be used to select key environmental covariates [@GuisanThuiller2005]. This selection process requires choosing appropriate habitat variables from among a suite of intercorrelated covariates while avoiding overfitting [@Hoeting2009; @MerowEtAl2014]. Most predictive models involve assumptions about the form of the response function between the occurrence or abundance of an organism and individual biophysical features. However, the information needed to inform these assumptions is typically unknown prior to analysis, which may lead to poor model performance [@Austin2007; @MainaliEtAl2015]. Temporal variation in both the distribution and habitat preferences of a species can introduce further uncertainty, because organisms’ responses to changes in habitat conditions may not be instantaneous and may vary across the annual cycle [@SelonenEtAl2015; @YamanakaEtAl2015]. Furthermore, both occupancy and abundance may respond not only to biophysical habitat features, but also to the distribution of other organisms such as conspecifics, competitors, predators, or prey [@GuisanThuiller2005; @BlackburnEtAl2006]. 

Aside from their ecological complexity, survey data can present several statistical challenges to modeling and interpretation. Surveys can be modeled using occupancy (presence/absence) or abundance (numerical) approaches, which measure different aspects of habitat use and have different distributions and response functions. Given the additional statistical complexity involved in interpreting count data, abundance estimates are often overlooked when mapping the distribution of organisms [@HeGaston2000]; however, occupancy estimates alone may provide incomplete or misleading information about habitat quality [@Pulliam2000]. Variation in abundance is often a key component of a species’ response to habitat quality and is crucial for accurately predicting species distributions [@HowardEtAl2014; @JohnstonEtAl2015]. The statistically challenging features of count data—particularly overdispersion, in which the variance of the data exceeds the mean—may in fact represent important biological responses to environmental features and conditions [@Richards2008; @McmahonEtAl2017]. Modeling count data also often requires accounting for zero-inflation [@MartinEtAl2005], non-linear responses to covariates [@CunninghamLindenmayer2005], and spatial and temporal autocorrelation [@Hoeting2009], which require a highly flexible modeling approach with few assumptions about either underlying distribution or response functions. 

Generalized additive models [GAMs: @HastieTibshirani1990] and their extension, GAMs for location, scale, and shape [GAMLSS: @RigbyStasinopoulos2005] offer several features that make them well-suited for modelling complex, uncertain, or variable relationships between survey data and environmental covariates. GAMs do not assume linear effects on the response but flexibly adapt to the observed data, which makes them especially applicable to systems in which the form of the relationship between species occupancy, abundance, and underlying environmental conditions is often non-linear and unknown [@GuisanZimmermann2000]. Moreover, unlike other generalized modeling approaches, GAMLSS allow both the mean and dispersion of the response to be modeled as a function of environmental covariates [@RigbyStasinopoulos2005], which incorporates additional information about count data not reflected by mean values alone [@McmahonEtAl2017]. Despite these promising features, although GAM has recently gained popularity as a predictive distribution modeling approach [e.g., @MillerEtAl2013], GAMLSS have yet to be widely adopted for modeling the spatial distribution of species based on biophysical features.

We propose a powerful, iterative modeling approach that combines GAM and GAMLSS in a gradient descent boosting framework [@HothornEtAl2010; @MayrEtAl2012a; @HofnerEtAl2016] to address the challenges of predicting occupancy and abundance from survey data in highly variable environments. Our approach independently evaluates environmental covariates for both occupancy and abundance, while allowing response functions to vary. We generate a single distribution estimate based on both occupancy and abundance that can be applied to environments with high levels of spatiotemporal variation and uncertainty. As a case study, we applied our proposed modeling framework to sea ducks (tribe Mergini) in Nantucket Bay, Massachusetts, USA. Understanding the winter habitat use and distribution of sea ducks in southern New England is crucial for the siting of proposed offshore wind farms [@Langston2013; @BradburyEtAl2014]; however, the implicitly high spatial and temporal variability of sea duck distributions, as well as poor understanding of habitat factors driving temporal and spatial variation in their distribution, has previously limited fine-scale prediction of habitat use in the proposed construction area [@BowmanEtAl2015]. We demonstrate an application of our modeling framework to informing conservation planning in the face of both high variability and ecological uncertainty by developing models from systematic aerial survey data of sea ducks in this system.

## Materials and methods

Our predictive approach incorporates five distinct methodological steps: (1) survey data collection, (2) separation of presence from abundance, (3) integration of environmental covariates, (4) synthesis of presence and abundance models, and (5) validation, which correspond to numbered sections in the model schematic (Fig. 1). We describe these five steps sequentially below, along with details of how we applied the modeling process to our case study of sea ducks in Nantucket Sound. All analyses were conducted in R [@RCoreTeam2018] with the add-on packages gamboostLSS [@HofnerEtAl2015], mboost [@HothornEtAl2015], and stabs [@HofnerHothorn2015]. 

*1. Surveys*

*Study system*---We conducted fieldwork throughout Nantucket Sound in Massachusetts, USA (Fig. 2). Our study area encompassed ca. 1,500 km2 of Nantucket Sound, was relatively shallow (generally < 20 m deep), and included some of the most important sea duck wintering habitat in the western Atlantic [@WhiteEtAl2009; @SilvermanEtAl2013]. The primary species of sea ducks found in Nantucket Sound were Common Eider (Somateria mollissima; hereafter eider), Black Scoter (Melanitta. americana), Surf Scoter (M. perspicillata), White-winged Scoter (M. deglandi), and Long-tailed Duck (Clangula hyemalis). Approximately 62 km^2^ of Horseshoe Shoal in northwestern Nantucket Sound is fully permitted for offshore wind energy development (OWED) [Fig. 2; @SantoraEtAl2004], although the proposed development was recently withdrawn.  

*Survey design*---During the boreal winters of 2003-2005, we conducted 30 (2003/2004: 13, 2004/2005: 10, 2005/2006: 7) standardized aerial strip-transect surveys [@FlandersEtAl2015] (Fig. 2). Surveys occurred primarily from November - March (n = 27), with occasional October (n = 1) or April (n = 2) surveys. During each survey, we flew along 15 parallel (ca. 2.5 km apart), roughly north-south transects (Fig. 2) using a high-wing, twin-engine Cessna Skymaster 337. We flew at an average altitude of 152 m and speed of 167 kmh-1 (90 kts), the slowest speed at which the aircraft could safely fly. This altitude allowed us to identify most birds at the sea surface and reduced disturbance (i.e., flushing birds to another part of the study area and potential double counting). We conducted surveys only on days with wind speeds $\leq$ 15 kts and good visibility (>15 km). Surveys had an average duration of ~2.5 h and occurred between 0900 to 1600 h to ensure that birds had completed any post-dawn movements [e.g., @Davis1997] but had yet to initiate pre-sunset movements from feeding to roosting areas; this time window also reduced glare for observers due to low sun angles.

On each survey flight, two observers used their unaided eyes to continuously detect individuals or flocks, identified sea ducks to species with the aid of binoculars as needed, and communicated the number, species, and behavior (on the water or flying) of observed ducks to a recorder who entered georeferenced locations using dLOG [@Ford1999]. Observers monitored the sea surface on their side of the plane in a ca. 91 m-wide transect between ca. 56 - 147 m from the plane. The narrow strip width ensured birds were detectable and identifiable with the naked eye and limited situations in which ducks were too abundant or spread over too wide an area to count accurately. We attempted to limit perception bias [i.e., to miss few individuals present to be counted; @MarshSinclair1989] by using low flight altitudes and narrow transect widths [e.g., @CertainBretagnolle2008; @BucklandEtAl2012]; however, our survey methods did not address potential undercounting of individuals that were diving during flyovers, and therefore may not have been present to be detected. Transect dimensions resulted in the sampling of approximately 6% (median; 68.4 km^2^) of the study area during a survey.

Due to difficulties associated with identifying to species the three species of scoters, we pooled all scoter observations (hereafter, scoters), while we modeled Common eider and Long-tailed duck as separate species. While using pooled data from multiple scoter species reduces our ability to make inferences about species-specific ecology and habitat use, scoters overlap broadly in shared wintering habitat across the study region and are generally subject to common conservation and management regimes. We subsequently consolidated counts for each species (eider and Long-tailed Duck) or species group (scoters) into 2.25 km^2^ segments (Fig. 2); this resolution (1.5 km x 1.5 km) corresponded approximately to the coarsest level of resolution of biophysical covariates (see below).

*2. Presence and abundance*

We related spatiotemporal variation in sea duck occupancy (i.e., probability of presence) and abundance to potentially relevant biophysical and spatiotemporal covariates. Because we observed a high incidence of zero counts (e.g., no eiders were detected in 75% of segment observations), and we assumed our survey design led to a low incidence of false zeros in study segments [@CertainBretagnolle2008], we applied a negative binomial hurdle model [@ManteEtAl2016]. This approach allowed us to model presence/absence in all grid cells, and abundance only in cells where at least one individual was detected.

We first used a logistic regression model to represent the probability of occurrence of at least one individual (hereafter, the occupancy model) in a given segment (Fig. 1.2). We then used a truncated negative binomial model to represent the abundance of sea ducks in that segment conditional on their presence (hereafter, the count model) (Fig. 1.2). Occupancy and abundance values correspond to the probability of sea duck presence (occupancy) or sea duck abundance in a 1.5 km x ca. 180 m transect through a given segment during a single survey.  We generated separate hurdle models for two sea duck species (Common eider and Long-tailed Duck) and one species group (scoters) [@ZipkinEtAl2010]. 

*3. Environmental covariates*

*Covariates*---Distribution of large marine vertebrates is primarily a function of the distribution of preferred prey items. Since we did not have direct measurements of the availability of sea duck benthic prey (e.g., mollusks and crustaceans), we evaluated biophysical covariates expected to influence the distribution and abundance of these organisms, including water depth, sediment grain size, and primary productivity (Table 1). Additionally, we included interactions with time that allowed the effects of two ecological covariates (water depth and relative sea surface temperature) and all spatial covariates to vary over time within a given winter. We standardized (i.e., mean centered and scaled) all continuous covariates. 

*Modeling approach*---To relate occupancy and abundance data to environmental covariates, we used additive models (Fig. 1.3).  We implemented a GAM for occupancy that flexibly accommodated varying effects of covariates on presence/absence data [@HastieTibshirani1990; @Wood2006].  For abundance data, we used a GAMLSS approach [@RigbyStasinopoulos2005]. Using GAMLSS allowed us to independently model dispersion of count data in relation to biophysical features, as well as account for potential non-linear or heterogeneous responses of abundance to underlying environmental covariates [@StasinopoulosRigby2007]. 

We fitted GAM and GAMLSS using an iterative machine-learning approach, component-wise functional gradient descent boosting [@BuhlmannHothorn2007; @HothornEtAl2010; @MayrEtAl2012a; @HofnerEtAl2015a; @HothornEtAl2015; @MayrHofner2018] in a cyclical framework [@ThomasEtAl2018]. The first step of this process was to compute the negative gradient of a pre-selected loss function, which acts as a working residual by giving more weight to observations not properly predicted in previous iterations. We used the binomial log-likelihood as the loss function for occupancy models and the truncated negative binomial log-likelihood as the loss function for count models. For GAM, we computed the negative gradient of the mean only. For GAMLSS, we computed the negative gradient separately for mean and overdispersion in each iteration while holding the other parameter as a fixed constant [@MayrEtAl2012a]. 

In the next step, we fitted various functional forms of each covariate relative to each response, called base-learners [@HofnerEtAl2014] to the negative gradients of the models. For each continuous covariate, we specified two possible base-learners: a linear base-learner and a base-learner for the smooth deviation from the linear effect via penalized splines [i.e., P-splines; @EilersMarx1996; @SchmidHothorn2008]. This allowed the model to select the best alternative for each covariate between no effect, linear effect, and smooth effect. For categorical covariates, we coded the categories and used a separate linear base-learner for each category, excepting a reference category (i.e., dummy-coding). To address potential spatial autocorrelation, we included a smooth surface function of the spatial coordinates of segment centers [@KneibEtAl2008], which accounted for underlying variance in sampling units similarly to a random effect term in a linear model. This surface comprised four base-learners—linear base-learners for the easting and northing, their linear interaction, and a penalized nonlinear tensor product [@KneibEtAl2008; @KneibEtAl2009; @MaloneyEtAl2012]. We also allowed this surface to vary over time within a winter via an interaction. The decomposition of continuous covariates into linear and penalized nonlinear base-learners reduced bias and overfitting by preventing the preferential selection of smooth base-learners [@KneibEtAl2009; @HofnerEtAl2011a]. Thus, we restricted each base-learner to a single degree of freedom and omitted the intercept term from each base-learner [@KneibEtAl2009; @HofnerEtAl2011a] and added a linear base-learner to the overall model to represent the model intercept. Once all potential base-learners had been tested, the single best fitting base-learner was added to the current model fit. As only the single best-fitting base-learner was selected in each iteration, the algorithm integrated intrinsic selection of the most relevant covariates and their functional form. 

In order to maximize predictive accuracy while avoiding model overfitting, we employed an early stopping mechanism [@MayrEtAl2012a; @MaloneyEtAl2012] during variable selection by stopping the algorithm prior to convergence to maximum likelihood estimates. In other words, after adding the best-fitting base learner to the model, the negative gradient was then reevaluated at the current model fit and the procedure of testing, comparing, and adding base-learners (Figure 1.3) was repeated until a pre-specified number of iterations was reached [@BuhlmannHothorn2007].  We used 25-fold subsampling to determine the optimal stopping iteration for each model. Specifically, we randomly drew (without replacement) 25 samples of size *n*/2 from the original data set. We used the selected sample to estimate the model and the balance of the data in each sample to determine the out-of-bag prediction accuracy (empirical risk) measured by the negative log-likelihood of each model; the optimal stopping iteration ($m_{stop}$) is the iteration with the lowest average empirical risk. In boosted GAMLSS models we used multi-dimensional subsampling to determine the stopping iteration for each of the GAMLSS parameters while allowing for potentially different model complexities in the parameters; a detailed explanation of this cross-validation (subsampling) scheme is given in @HofnerEtAl2016. 

Since boosting methods typically produce "rich" models relying to some extent on many base-learners [@HofnerEtAl2015a], we additionally used stability selection to compare the relative importance of covariates. Briefly, this process involved modeling subsamples of the data and measuring the frequency with which each covariate was included in the final models [@HofnerEtAl2015a]. The methodology and results of this analysis are included in the Supporting Information (S.1).

*4. Synthesis*

Both GAM and GAMLSS models took the following general form:

$g(\cdot) =  int + covariate_1 + f(covariate_1) + covariate_n + f(covariate_n)$

For occupancy models (GAM), we modeled the occupancy probability of a given duck species in a segment $g(\pi_{\text{sea ducks}})$ as a function of all environmental covariates (Table 1), with $g$ representing the logit link. Count models (GAMLSS) took two forms: the (conditional) mean count of sea ducks, $g(\mu_{\text{sea ducks}})$, and the (conditional) overdispersion in sea duck counts, $g(\sigma_{\text{sea ducks}})$; $g$ is the log link in both cases. The same environmental covariates were included in both models (Table 1). $f(\cdot)$ indicates the penalized nonlinear deviations from the corresponding linear base-learners (e.g., $f(time)$) and were included for all non-categorical variables.

We included interaction terms between easting (*xkm*), northing (*ykm*), and day of year (*time*) to incorporate spatiotemporal effects. The explicit intercept (*int*) was a necessary byproduct of our decomposition of base-learners [@KneibEtAl2009; @HofnerEtAl2011a]. We included *obs_window*, our measure of survey effort (Table 1), as a covariate rather than an offset because small values in some segments impaired estimability.

Subsequent to their independent fitting, we consolidated occupancy and conditional count models into a single model [see Equation 6 in @ZeileisEtAl2008] to generate unconditional, spatially-explicit estimates of sea duck abundance.  

*5. Validation*

Since additional test data were not available for our study area, we used a pseudo R^2^ measure of the explained variation [@Nagelkerke1991; @MaloneyEtAl2012] to evaluate the approximate explanatory power of our final models. We obtained the pseudo R^2^ value by comparing the log likelihood values for our model-generated estimates of unconditional abundance for each species to log likelihood values obtained from null (intercept-only) models, giving us an estimate of the increase in explanatory power provided by our models.

## Results

For each species or species group, we fitted independent models for occupancy and conditional count data (mean and overdispersion). Bootstrapped empirical risk suggested that occupancy models for all species converged to the maximum likelihood estimates (i.e., occupancy models failed to stop early; see Supporting Information, S.2). Conversely, bootstrapped empirical risks prescribed early stopping for both the conditional mean and overdispersion parameter in all count models (see Supporting Information, S.2). Final occupancy models and models for the conditional mean of count data included only a subset (12% to 38%) of the 48 base-learners initially specified for selection. Occupancy models generally contained more covariates and their interactions (8-10 of 23) than did count models (3-6 of 23), particularly among stably selected covariates and their interactions (Fig. 3, see also Supporting Information, S.3).

*Sea duck occupancy*---Three covariates--—grain size, sea surface temperature, and distance to land--—were associated with probability of occurrence for all three sea duck species or species groups (Fig. 3). Standardized effects of each variable on the response can be compared among species and covariates within a model based on their range on the Y-axis. For example, monthly sea surface temperature (*SST~m~*) spanned a larger range of the Y-axis, and thus associated more strongly with eider occupancy, than did distance to land (*d2land*) (Fig. 3). In contrast, monthly sea surface temperature (*SST~m~*) associated much more strongly with occupancy of Long-tailed Duck than with eider or scoters (Fig. 3). Detailed comparisons of univariate, bivariate, and categorical effects for each species are included in the Supporting Information (S.3).

Spatiotemporal effects (i.e., occupancy associated with the *xkm*-*ykm* location of segments and the change over time within winter [*time*]) were the dominant explanatory feature in occupancy models, although these patterns varied considerably among species (Fig. 3; see Day of season, Northing x Easting). Occupancy increased, but at a decreasing rate, with survey effort (*obs_window*) in a given segment (Fig. 3). Occupancy estimates increased at intermediate monthly sea surface temperature (SSTm), greater distances from land (d2land), and in areas with coarser sediments (i.e., smaller *meanphi*). Eider occupancy was associated negatively with chromomorphic dissolved organic material (*cdom*) and positively with sea floor surface area relative to planimetric area (*SAR*; our measure of the topographic variability of the sea floor; Fig. 3), whereas scoter occupancy likewise related to *SAR* and *cdom*, but in the opposite direction in both cases (Fig. 3). Scoters occupancy was modestly greater in deeper waters (*depth*), whereas Long-tailed Duck occupancy was greatest in shallow waters early in the winter but in deeper waters later in the winter (Fig. 3; *depth* x *time* covariate). Other effects were relatively minor and inconsistent among species.

The predominance of spatial effects (*ykm*-*xkm*) resulted in distinct spatial patterns of occupancy among species (Fig. 4, top row) despite the relative similarity of occupancy associations with biophysical covariates (Fig. 3). Occupancy was typically highest for eider in northwest and southwest Nantucket Sound, in interior Nantucket Sound for scoters, and in northeast and south Nantucket Sound for Long-tailed Duck (Fig. 4, top row). All species tended to avoid the western edge of the Sound northeast of Martha's Vineyard. Generally, the areas of highest occupancy exhibited the lowest relative variability (Fig. 4, bottom row), defined as the median absolute deviation (MAD) of occupancy relative to median occupancy within a segment (a measure analogous to the coefficient of variation, but in this case providing an estimate of temporal variability).

*Sea duck conditional abundance and overdispersion.*---Spatial effects (*ykm*-*xkm*) were the dominant explanatory feature of conditional abundance estimates for scoters and Long-tailed Duck, but they were not selected in the eider model (Fig. 3). In contrast with the corresponding occupancy model, scoter conditional abundance decreased with increasing sediment grain size (*meanphi*).  Additionally, the relationships between eider conditional abundance and dissolved organic material (*cdom*) and sea floor topography (*SAR*; Fig. 3) were more complex than with eider occupancy. The conditional abundance of eider and scoter was also associated with relatively warm or cool sea surface temperatures (*SST~rel~*; Fig. 3). Biophysical covariates associated with Long-tailed Duck conditional abundance exhibited general agreement with their counterpart in the occupancy models.

Spatially-explicit patterns of occupancy (cf. Fig. 4, top row) did not necessarily reflect patterns of median conditional abundance (Fig. 5, top row). Some areas of Nantucket Sound exhibited mutually high conditional abundance and occupancy for a given species (e.g., eider in the southwest, scoter in the interior, and Long-tailed Duck in parts of the northeast). However, conditional abundance was low despite relatively high occupancy in some instances (e.g., eider in the northeast and Horseshoe Shoal, scoters in the northeast and southeast, and Long-tailed Duck along the northern margin). Conversely, other areas of Nantucket Sound exhibited lower occupancy but sea ducks, when present, were more abundant (e.g., eider along the eastern margin, and scoters and Long-tailed Duck in the southwest). As in occupancy models, sea ducks were relatively absent from the middle-western margin of Nantucket Sound (i.e., northeast of Martha's Vineyard; see Fig. 3). In contrast to occupancy, which was less variable in areas of high abundance, areas of high conditional sea duck abundance typically also exhibited high relative variability over time (Fig. 5, bottom row).

Overdispersion in conditional sea duck abundance also varied with biophysical covariates, although relationships were less consistent among species (Fig. 3; see also Supporting Information, S.3). Variability (i.e., overdispersion) in sea duck counts was heterogeneous in space and time in Nantucket Sound (Supporting Information, S.4), particularly for eider and scoters (as indicated by the magnitude of the overdispersion parameter values).

```{r evaluate_models, eval=FALSE}
# Need specific versions of packages for the saved models to run
pacman::p_load(devtools)
if (!requireNamespace("mboost", quietly = TRUE))
      devtools::install_version("mboost", version = "2.4-2", repos = "http://cran.us.r-project.org")
if (packageVersion("mboost") != "2.4.2")
    devtools::install_version("mboost", version = "2.4-2", repos = "http://cran.us.r-project.org")
if (!requireNamespace("gamboostLSS", quietly = TRUE))
    devtools::install_version("gamboostLSS", version = "1.2-0", repos = "http://cran.us.r-project.org")
if (packageVersion("gamboostLSS") != "1.2.0")
    devtools::install_version("gamboostLSS", version = "1.2-0", repos = "http://cran.us.r-project.org")

# How pseudo R2 was calculated
source("../R/pseudoR2.R")
source("../R/load_sea_duck_models.R") # Large files; can type a minute or two
(COEI_r2 <- round(pseudoR2(COEIocc, COEIcc, coei), 2))
(SCOT_r2 <- round(pseudoR2(SCOTocc, SCOTcc, scot), 2))
(LTDU_r2 <- round(pseudoR2(LTDUocc, LTDUcc, ltdu), 2))
```

*Expected sea duck abundance*---Consolidated occupancy and conditional count models provided estimates of unconditional sea duck abundance in the study area over the survey period. Final models of expected sea duck abundance explained moderate amounts of variation in observed counts of eider, scoters, and Long-tailed Duck (pseudo R^2^ = 0.31, 0.48, and 0.32, respectively). Conditional abundance (Fig. 5) strongly influenced the spatially-explicit patterns of expected abundance. Sea duck species exhibited relatively distinct patterns of abundance in Nantucket Sound. Eider were consistently most abundant in southwestern Nantucket Sound. They also were relatively abundant in the northeastern part of the study area but less consistently based on the relatively high MAD/median abundance over time (Fig. 6). Scoters were also most abundant, with occasional extremely large flocks, in southwestern Nantucket Sound.  This was also the area of highest relative variation in scoter abundance; relatively high abundances of scoters also occurred in interior Nantucket Sound (Fig. 6). Long-tailed Ducks were consistently most abundant in northeastern Nantucket Sound, as well as along its southern margin (Fig. 6). No species' highest abundances occurred in the permitted Nantucket Shoal area, although expected eider and scoters abundances were consistently elevated in some parts of the Shoal (west and southeast, respectively; Fig. 6).

Summing the spatially-explicit estimates of unconditional sea duck abundance (i.e., Fig. 6) provides an estimate of total abundance in a 1.5 km x 180 m transect through all segments in the study area. We calculated overall abundance by species throughout the study area by extrapolating these estimates across the full study area (Fig. 7). Although absolute estimates differed between study years, patterns of abundance were similar across years, with scoter and long-tailed duck abundances highest early in the season, and eider abundance peaking in mid-winter. We also compared the total count (summed across all segments) of each sea duck species observed in aerial strip transects with the corresponding estimated total abundance in surveyed segments for each of the 30 aerial surveys (Fig. 8). Our models tended to overestimate sea duck abundance when the actual numbers of sea ducks were relatively low, although overestimation was typically less than an order of magnitude. This pattern may have resulted from patterns of seasonal variation: since not all individuals arrive in or depart from the study area at the same time, individuals present in the study area early and late in the winter season likely occurred in lower densities than expected relative to habitat features. Additionally, scoter abundance was occasionally extreme relative to typical counts and somewhat prone to underestimation during these extreme counts, likely because extremely high counts were too infrequent to allow accurate assessment of the factors influencing their occurrence. Nonetheless, the general adherence of observed and predicted abundance to a line of unit slope indicated that it may be reasonable to estimate sea duck abundance for the entire study area based on observed sea duck densities in transects (Fig. 8).

*Temporal dynamics in wintering sea ducks*---The MAD/median estimates (Figs 4-6, bottom rows; Supporting Information, S.4) show that our spatially-explicit estimates of occupancy, abundance, and overdispersion invariably change over time, either explicitly via the selection of a within- or among-winter temporal effect (*time* and *y2004*/*y2005*, respectively) or implicitly via the selection of biophysical covariates that change within or among winters. The temporal dynamics of the wintering sea duck system in Nantucket Sound was one of its most striking attributes, and we illustrate these dynamics with an animation for scoter occupancy and abundance in the Supporting Information (S.5). 

## Discussion

We demonstrated a flexible model-based approach to evaluate the environmental associations of sea duck distribution and abundance based on multiyear replicated surveys. The boosted GAMLSS framework offered several useful features including (1) the ability to model all parameters of the conditional distribution (e.g., conditional mean and overdispersion) as a function of covariates, (2) integrated variable reduction and selection among many covariates, and (3) integrated model selection via model decomposition of continuous covariates and thus the simultaneous consideration of competing functional forms (e.g., linear vs. non-linear). Additionally, this framework allowed us to incorporate smooth effects to efficiently account for spatiotemporal trends in the data that were poorly explained by other covariates and to identify those covariates and their functional forms most consistently associated with animal distribution and abundance (via stability selection). Recent advances in the application of gradient boosting [non-cyclical application: see @ThomasEtAl2018] could allow for even greater power in selecting appropriate variables and responses from among available covariates.

Although negative binomial hurdles and boosted GAM/GAMLSS have previously been used to predict organism distributions, to the best of our knowledge, they have not yet been combined into a single modeling framework. In order to effectively model organism distributions in relation to biophysical features from survey data, both modeling components address important characteristics of the data. Applying a negative binomial hurdle allows simultaneous modeling of both presence/absence and abundance data, and subsequently applying GAM and GAMLSS accounts for unique aspects of each data type, particularly overdispersion of the abundance (count) portion of the data. As a final step, the data are recombined to produce predictions that flexibly incorporate a wide range of potential responses to environmental covariates, which is particularly crucial in systems with little a priori knowledge regarding the relationships between organism distributions and environmental covariates. These predictions can be used to generate a variety of information on species abundance and distribution, including overall abundance estimates (this study), as well as estimates of prediction error, which can be generated via bootstrapping by repeated runs of the model [@HofnerEtAl2016a].

The useful features of this modeling framework apply especially to mobile species with non-uniform distributions that vary among and within years, such as the species of sea ducks that we studied.  Our estimates of the spatiotemporal abundance of sea ducks in Nantucket Sound were controlled largely by estimates of the conditional abundance and less by spatiotemporal patterns in the occupancy of sea ducks. This suggests that occupancy models alone may be inadequate for assessing risk from anthropogenic disturbances and for describing the fine-scale distribution of marine species. Previously, the statistically challenging features of count data have restricted their use in distribution models, meaning that most predictions have addressed only occupancy [e.g., @WiniarskiEtAl2014; @FlandersEtAl2015], and may thus have ignored important facets of sea duck distribution and risk exposure, particularly variation in abundance. For species such as sea ducks, which gather in dense social aggregations at preferred habitat locations, flock size is a key component of distributional patterns as it both reflects and enhances habitat suitability [e.g., @GuillemetteEtAl1993] and may affect the distribution and intensity of risk factors on individuals [e.g., @SchwemmerEtAl2011]. Our modeling approach thus allows us to examine key features of sea duck distribution patterns that have been overlooked in previous studies.

*Environmental covariates that best explain sea duck distribution and abundance*---The biophysical associations with sea duck occupancy derived from our models were relatively consistent among species, whereas their associations with sea duck conditional abundance were more species-specific.  Distance to land, which was associated with both occupancy and abundance, tends to be positively associated with bathymetry and often has a strong influence on sea duck occupancy estimates [@GuillemetteEtAl1993, @LewisEtAl2008; @WiniarskiEtAl2014, @FlandersEtAl2015].  Sediment grain size can also affect prey availability for foraging sea ducks [@GoudieAnkney1988; @LovvornEtAl2009; @LoringEtAl2013] and was associated with occupancy and conditional abundance in this study.  In addition, topographic variability of the sea floor also influenced occupancy and conditional abundance, although its relationship to prey availability is less understood.  We did not find evidence for temporally varying associations of sea duck assemblages with dynamic oceanographic conditions such as sea surface temperature, chlorophyll a, or the North Atlantic Oscillation (NAO). These results contrast with several previous studies of sea duck occupancy [@ZipkinEtAl2010; @FlandersEtAl2015] that have documented effects of dynamic oceanographic conditions on sea duck distributions. Certain covariates may associate with marine bird abundance or behavior at specific scales and not at others [@LogerwellHargreaves1996; @MannocciEtAl2017]; thus, the smaller spatial scale of our analysis compared to previous studies may explain the apparent discrepancy between studies in the effect of chlorophyll a and NAO.

The unexplained variation in our models and the predominance of marginal spatiotemporal effects suggest that we likely missed important variable(s) relevant to the distribution of sea ducks in Nantucket Sound.  This lack of explanatory power suggests a need for better biophysical proxies for the distribution of prey eaten by sea ducks or concurrent prey distribution information [e.g., @VaitkusBubinas2001; @KaiserEtAl2006; @ZydelisEtAl2009; @CervenclFernandez2012; @CervenclEtAl2014], although such data are challenging to obtain at appropriate resolutions and may not guarantee improved predictive accuracy [@GremilletEtAl2008; @TorresEtAl2008; @Benoit-BirdEtAl2013]. Additionally, our survey methods may have resulted in either over- or under-counting, depending on both movement and diving behavior of birds. Given the dominant effects of large flock sizes on our predictions, we expect that the magnitude of detection bias would not have been large enough to substantially affect our results. However, future surveys could benefit from recent developments in survey design [e.g., @ConnAlisauskas2018] that have been proposed to address the particular biases associated with aerial counts of waterfowl.

*The importance of spatial scale*---The process whereby migratory animals such as sea ducks select a given area to inhabit during winter involves decisions at multiple spatial scales and the environmental attributes that determine this habitat selection often vary with spatial scale [@Johnson1980; @JohnsonEtAl2004; @JohnsonEtAl2006]. The majority of North American sea ducks migrate from high-latitude arctic and sub-arctic breeding areas to mid-latitude temperate wintering areas where they reside for most of the year [@SilvermanEtAl2013; @BowmanEtAl2015; @FlandersEtAl2015]. At these large spatial scales, the distribution and abundance of sea ducks during winter may be affected by large-scale ocean characteristics [e.g., @Flint2013], climatic conditions [e.g., @ZipkinEtAl2010], and static or persistent habitat features (e.g., bathymetry, substrate, current and frontal systems; @HyrenbachEtAl2000; @NurEtAl2011; @FlandersEtAl2015].  At regional and local scales, however, most species of sea ducks congregate in large flocks (e.g., up to tens of thousands of birds) at sites where prey are abundant and accessible [@LoringEtAl2013; @Flint2013] although the abundance and distribution of these prey, and thus predators, can be extremely ephemeral and dynamic [@HyrenbachEtAl2000; @CisnerosEtAl2011]. 

Given that sea duck distribution and abundance is spatially and temporally dynamic, yet expected to be driven by biophysical covariates [@OppelEtAl2009; @ZipkinEtAl2010; @FlandersEtAl2015] that may differ in importance depending on spatial scale [@Johnson1980; @JohnsonEtAl2004; @JohnsonEtAl2006], marine spatial planners must carefully consider the most appropriate information to use when deciding, for example, where to place marine protected areas or offshore wind energy developments to meet conservation and management goals. A larger-scale occupancy model developed by @FlandersEtAl2015 suggested that eiders were relatively uniformly distributed across Nantucket Sound, whereas our higher resolution abundance models found that eiders were concentrated in southwestern and central, eastern areas within Nantucket Sound.  While large-scale models [@SilvermanEtAl2013; @FlandersEtAl2015] are useful to identify general geographic areas of importance to sea ducks, our models provide more detailed estimates of sea duck distribution and abundance within a specific area of interest. In terms of marine spatial planning, large-scale models can be used to inform the siting of lease areas or protected areas, followed by detailed modeling approach such as ours to select sites within these larger blocks that can be zoned for specific levels of development or protection.

## Acknowledgments

We thank Simon Perkins, Liz Brousseau, Ellen Jedrey, and Andrea Jones for help with the design and collection of survey data in the Nantucket Sound study plot and the late Jon Ambroult and Ambroult Aviation for their skill and dedication in flying the planes in Nantucket Sound. The Island Foundation, the Mass Technology Collaborative, Sea Duck Joint Venture, Foundation M, Massachusetts Environmental Trust, and Mass Audubon all contributed financial support for the aerial surveys in Nantucket Sound and we thank these groups. Funding and institutional support for this analysis was provided by the University of Rhode Island and Rhode Island Department of Environmental Management. 

## Author Contributions

TA and GS designed and collected the survey data; AS, BH, SM, and PP conceived the analytical methodology; AS and BH analysed the data; AS, JL, BH, SM, and PP led the writing and editing of the manuscript; AS and JL designed tables and figures. All authors contributed critically to the drafts and gave final approval for publication.

## Data access

Upon publication, the data and code for reproducing this manuscript and analyses as well as final fitted models will be provided freely via Zenodo.

## Literature Cited
\hangparas{16pt}{1}

<div id="refs"></div>

\newpage
\singlespacing

```{r Table1, child="Table1.Rmd"}
```

\newpage

```{r Figures, child="Figures.Rmd"}
```
